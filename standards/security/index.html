<!doctype html>
<html lang="fa-IR" dir="rtl" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-standards/security" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Ù„ÛŒØ³ØªÙ… Ù…ÙˆØ§Ø±Ø¯ Ø§Ù…Ù†ÛŒØªÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ ÙˆØ¨ | Ú©Ù†Ø§Ø± Ø¯ÛŒÙˆØ§Ø±</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://divar-ir.github.io/kenar-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://divar-ir.github.io/kenar-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://divar-ir.github.io/kenar-docs/standards/security"><meta data-rh="true" property="og:locale" content="fa_IR"><meta data-rh="true" name="docusaurus_locale" content="fa-IR"><meta data-rh="true" name="docsearch:language" content="fa-IR"><meta data-rh="true" name="title" content="Ú©Ù†Ø§Ø± Ø¯ÛŒÙˆØ§Ø±"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Ù„ÛŒØ³ØªÙ… Ù…ÙˆØ§Ø±Ø¯ Ø§Ù…Ù†ÛŒØªÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ ÙˆØ¨ | Ú©Ù†Ø§Ø± Ø¯ÛŒÙˆØ§Ø±"><meta data-rh="true" name="description" content="Data Encryption &amp; Protection"><meta data-rh="true" property="og:description" content="Data Encryption &amp; Protection"><link data-rh="true" rel="icon" href="/kenar-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://divar-ir.github.io/kenar-docs/standards/security"><link data-rh="true" rel="alternate" href="https://divar-ir.github.io/kenar-docs/standards/security" hreflang="fa-IR"><link data-rh="true" rel="alternate" href="https://divar-ir.github.io/kenar-docs/standards/security" hreflang="x-default"><link rel="stylesheet" href="/kenar-docs/assets/css/styles.d9f4986f.css">
<script src="/kenar-docs/assets/js/runtime~main.375e7207.js" defer="defer"></script>
<script src="/kenar-docs/assets/js/main.bf57e9d2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/kenar-docs/img/logo.svg"><div role="region" aria-label="Ù¾Ø±Ø´ Ø¨Ù‡ Ù…Ø·Ù„Ø¨ Ø§ØµÙ„ÛŒ"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Ù¾Ø±Ø´ Ø¨Ù‡ Ù…Ø·Ù„Ø¨ Ø§ØµÙ„ÛŒ</a></div><nav aria-label="ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Ø¨Ø§Ø² Ùˆ Ø¨Ø³Øª Ù…Ù†Ùˆ" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kenar-docs/"><div class="navbar__logo"><img src="/kenar-docs/img/logo.svg" alt="Ú©Ù†Ø§Ø± Ø¯ÛŒÙˆØ§Ø±" class="themedComponent_mlkZ themedComponent--light_NVdE" width="64"><img src="/kenar-docs/img/logo.svg" alt="Ú©Ù†Ø§Ø± Ø¯ÛŒÙˆØ§Ø±" class="themedComponent_mlkZ themedComponent--dark_xIcU" width="64"></div><b class="navbar__title text--truncate">| Ù…Ø³ØªÙ†Ø¯Ø§Øª ÙÙ†ÛŒ</b></a><a href="https://github.com/divar-ir/kenar-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Ø¨ÛŒÙ† Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ© Ùˆ Ø±ÙˆØ´Ù† Ø³ÙˆØ¦ÛŒÚ† Ú©Ù†ÛŒØ¯ (Ø§Ù„Ø§Ù† Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù†)" aria-label="Ø¨ÛŒÙ† Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ© Ùˆ Ø±ÙˆØ´Ù† Ø³ÙˆØ¦ÛŒÚ† Ú©Ù†ÛŒØ¯ (Ø§Ù„Ø§Ù† Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù†)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¨Ø§Ù„Ø§" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ Ù…Ø³ØªÙ†Ø¯Ø§Øª" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kenar-docs/">ReadMe</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/addons/">Ø§ÙØ²ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ ØµÙØ­Ù‡Ù” Ø¢Ú¯Ù‡ÛŒ</a><button aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø± Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ &#x27;Ø§ÙØ²ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ ØµÙØ­Ù‡Ù” Ø¢Ú¯Ù‡ÛŒ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kenar-docs/assets/">Ø§ÙØ³ÙØªâ€ŒÙ‡Ø§ assets</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/chat/">ğŸ’¬ Ø§ÙØ²ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ú†Øª Ø¯ÛŒÙˆØ§Ø±</a><button aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø± Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ &#x27;ğŸ’¬ Ø§ÙØ²ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ú†Øª Ø¯ÛŒÙˆØ§Ø±&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/events/">Ø¯Ø±ÛŒØ§ÙØª Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ Ø¯Ø± Ù„Ø­Ø¸Ù‡</a><button aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø± Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ &#x27;Ø¯Ø±ÛŒØ§ÙØª Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ Ø¯Ø± Ù„Ø­Ø¸Ù‡&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/finder/">Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¢Ú¯Ù‡ÛŒ</a><button aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø± Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ &#x27;Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¢Ú¯Ù‡ÛŒ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/management/">Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†â€ŒÙ‡Ø§</a><button aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø± Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ &#x27;Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†â€ŒÙ‡Ø§&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/kenar-docs/migrations/user_addon_v2+addon_v2+user_semantic">migrations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/misc/">Ù…ØªÙØ±Ù‚Ù‡</a><button aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø± Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ &#x27;Ù…ØªÙØ±Ù‚Ù‡&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/oauth/">Ø§Ø­Ø±Ø§Ø² Ø¨Ø§Ø²</a><button aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø± Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ &#x27;Ø§Ø­Ø±Ø§Ø² Ø¨Ø§Ø²&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/payment-ticket/">ÙÙ„ÙˆÛŒ ØªÛŒÚ©Øª Ù¾Ø±Ø¯Ø§Ø®Øª</a><button aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø± Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ &#x27;ÙÙ„ÙˆÛŒ ØªÛŒÚ©Øª Ù¾Ø±Ø¯Ø§Ø®Øª&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/kenar-docs/post/edit_post">post</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/semantic/">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø¹Ù†Ø§ÛŒÛŒ</a><button aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø± Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ &#x27;Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø¹Ù†Ø§ÛŒÛŒ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/kenar-docs/standards/">Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯Ù‡Ø§</a><button aria-label="Ø¨Ø³ØªÙ† Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø± Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ &#x27;Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯Ù‡Ø§&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kenar-docs/standards/policies">Ù‚ÙˆØ§Ø¹Ø¯ ÙØ¹Ø§Ù„ÛŒØª Ø¯Ø± Â«Ú©Ù†Ø§Ø± Ø¯ÛŒÙˆØ§Ø±Â»</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/kenar-docs/standards/security">Ù„ÛŒØ³ØªÙ… Ù…ÙˆØ§Ø±Ø¯ Ø§Ù…Ù†ÛŒØªÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ ÙˆØ¨</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/widgets/">Ø³Ø§Ø®ØªØ§Ø± ÙˆÛŒØ¬Øª Ù‡Ø§ÛŒ Ø¯ÛŒÙˆØ§Ø± (Widgets)</a><button aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯Ø± Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ &#x27;Ø³Ø§Ø®ØªØ§Ø± ÙˆÛŒØ¬Øª Ù‡Ø§ÛŒ Ø¯ÛŒÙˆØ§Ø± (Widgets)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Ù†Ø´Ø§Ù†Ú¯Ø± ØµÙØ­Ø§Øª"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ" class="breadcrumbs__link" href="/kenar-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/kenar-docs/standards/"><span itemprop="name">Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯Ù‡Ø§</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Ù„ÛŒØ³ØªÙ… Ù…ÙˆØ§Ø±Ø¯ Ø§Ù…Ù†ÛŒØªÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ ÙˆØ¨</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Ù…Ø·Ø§Ù„Ø¨ Ø§ÛŒÙ† ØµÙØ­Ù‡</button></div><div class="theme-doc-markdown markdown"><header><h1>Ù„ÛŒØ³ØªÙ… Ù…ÙˆØ§Ø±Ø¯ Ø§Ù…Ù†ÛŒØªÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ ÙˆØ¨</h1></header>
<div dir="ltr"><h1>Web Application Security Checklist</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-encryption--protection"><strong>Data Encryption &amp; Protection</strong><a href="#data-encryption--protection" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ data-encryption--protection" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ data-encryption--protection">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="encrypt-all-data-in-transit"><strong>Encrypt all data in transit:</strong><a href="#encrypt-all-data-in-transit" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ encrypt-all-data-in-transit" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ encrypt-all-data-in-transit">â€‹</a></h3><p>All customer data transmitted over networks must use TLS 1.2 or higher. Unencrypted protocols like HTTP or FTP are strictly prohibited. This prevents unauthorized interception during transfers.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="encrypt-all-data-at-rest"><strong>Encrypt all data at rest:</strong><a href="#encrypt-all-data-at-rest" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ encrypt-all-data-at-rest" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ encrypt-all-data-at-rest">â€‹</a></h3><p>Customer data stored in databases, backups, or cloud systems must be encrypted using AES-256. Encryption keys must be managed through certified services (e.g., AWS KMS, Azure Key Vault) and stored separately from encrypted data. This ensures protection even if physical storage is compromised.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tokenize-sensitive-fields"><strong>Tokenize sensitive fields:</strong><a href="#tokenize-sensitive-fields" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ tokenize-sensitive-fields" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ tokenize-sensitive-fields">â€‹</a></h3><p>Replace direct identifiers (e.g., emails, phone numbers) with tokens in non-production environments. Tokenization minimizes exposure if test systems are breached.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="do-not-store-pii-without-legal-enforcement"><strong>Do not store PII without legal enforcement:</strong><a href="#do-not-store-pii-without-legal-enforcement" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ do-not-store-pii-without-legal-enforcement" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ do-not-store-pii-without-legal-enforcement">â€‹</a></h3><p>Personally Identifiable Information (PII) must not be stored unless explicitly required by law or regulation. If stored, legal justification must be documented and approved in writing. This reduces liability and ensures compliance with privacy laws.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="access-control--authentication"><strong>Access Control &amp; Authentication</strong><a href="#access-control--authentication" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ access-control--authentication" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ access-control--authentication">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enforce-multi-factor-authentication-mfa"><strong>Enforce Multi-Factor Authentication (MFA):</strong><a href="#enforce-multi-factor-authentication-mfa" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ enforce-multi-factor-authentication-mfa" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ enforce-multi-factor-authentication-mfa">â€‹</a></h3><p>MFA (e.g., authenticator apps, hardware tokens) is mandatory for all accounts accessing customer data. This reduces risks from stolen passwords or compromised credentials.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="assign-role-based-access-permissions"><strong>Assign role-based access permissions:</strong><a href="#assign-role-based-access-permissions" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ assign-role-based-access-permissions" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ assign-role-based-access-permissions">â€‹</a></h3><p>Grant access strictly based on job roles (e.g., &quot;read-only&quot; for analysts, &quot;admin&quot; for IT teams). Conduct quarterly reviews to revoke unused accounts. Limiting access prevents accidental or intentional misuse.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="automatically-terminate-inactive-sessions"><strong>Automatically terminate inactive sessions:</strong><a href="#automatically-terminate-inactive-sessions" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ automatically-terminate-inactive-sessions" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ automatically-terminate-inactive-sessions">â€‹</a></h3><p>Sessions must timeout after 15 minutes of inactivity. Accounts unused for 6 months will be permanently disabled unless extended retention is legally required. This reduces exposure from unattended devices while accommodating legal obligations.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-handling--storage"><strong>Data Handling &amp; Storage</strong><a href="#data-handling--storage" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ data-handling--storage" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ data-handling--storage">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="delete-data-after-retention-periods"><strong>Delete data after retention periods:</strong><a href="#delete-data-after-retention-periods" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ delete-data-after-retention-periods" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ delete-data-after-retention-periods">â€‹</a></h3><p>Securely delete customer data within 6 months of contract termination using irreversible overwrite methods (e.g., NIST 800-88 standards). If legal enforcement requires extended retention, written approval and a data protection plan must be provided. This balances compliance with liability reduction.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="store-data-only-in-approved-environments"><strong>Store data only in approved environments:</strong><a href="#store-data-only-in-approved-environments" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ store-data-only-in-approved-environments" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ store-data-only-in-approved-environments">â€‹</a></h3><p>Use pre-approved encrypted platforms (e.g., AWS S3, Azure Blob Storage). Storage on personal devices, unauthorized cloud services, or unsecured physical media is prohibited. This ensures data remains in controlled, auditable environments.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mask-sensitive-data-in-logsuis"><strong>Mask sensitive data in logs/UIs:</strong><a href="#mask-sensitive-data-in-logsuis" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ mask-sensitive-data-in-logsuis" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ mask-sensitive-data-in-logsuis">â€‹</a></h3><p>Partially obscure sensitive information in internal systems (e.g., display only the last 4 digits of credit cards, replace full names with initials). This protects data even during routine operations or internal reviews.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="network-security"><strong>Network Security</strong><a href="#network-security" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ network-security" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ network-security">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="isolate-systems-with-firewallssegmentation"><strong>Isolate systems with firewalls/segmentation:</strong><a href="#isolate-systems-with-firewallssegmentation" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ isolate-systems-with-firewallssegmentation" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ isolate-systems-with-firewallssegmentation">â€‹</a></h3><p>Separate networks handling customer data using firewalls, VLANs, or software-defined segmentation. This limits attackersâ€™ ability to move laterally during breaches.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="secure-apis-with-authentication-and-rate-limits"><strong>Secure APIs with authentication and rate limits:</strong><a href="#secure-apis-with-authentication-and-rate-limits" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ secure-apis-with-authentication-and-rate-limits" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ secure-apis-with-authentication-and-rate-limits">â€‹</a></h3><p>Authenticate API calls using OAuth 2.0 or API keys. Enforce rate-limiting and monitor for abnormal usage patterns (e.g., sudden spikes in requests). This prevents unauthorized scraping or brute-force attacks.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-a-waf"><strong>Use a WAF</strong><a href="#use-a-waf" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-a-waf" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-a-waf">â€‹</a></h3><p>Put a web application firewall product in front of your application. This will make many vulnerabilities significantly harder to find and exploit. ModSecurity is a good open-source option.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://modsecurity.org/rules.html" target="_blank" rel="noopener noreferrer">ModSecurity</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-your-web-server-carefully-to-avoid-http-desync-attacks"><strong>Configure your web server carefully to avoid HTTP desync attacks</strong><a href="#configure-your-web-server-carefully-to-avoid-http-desync-attacks" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ configure-your-web-server-carefully-to-avoid-http-desync-attacks" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ configure-your-web-server-carefully-to-avoid-http-desync-attacks">â€‹</a></h3><p>There is an attack called &quot;HTTP Desync&quot; or &quot;Request Smuggling&quot;, which could allow for an attacker to do all sorts of nasty things, such as steal HTTP requests of random users collecting to the web application, if the following conditions are true:</p><ol>
<li>There is a frontend web server, such as a load balancer/any reverse proxy, that accepts requests with <em>both</em>, Content-Length and Transfer-Encoding headers, and passes them on without normalizing the request.</li>
<li>The next web server on the line, such as an application webserver, uses, or can be tricked to use, a different mechanism than the frontend webserver to determine where the HTTP request begins and where it ends, e.g. the frontend would use Content-Length whereas the application server would use Transfer-Encoding.</li>
<li>The front-end web server reuses the connection to the backend web server.</li>
<li>The frontend web server uses HTTP/1 (instead of HTTP/2) in the backend server connection.</li>
</ol><p>So how to protect yourself? Depends on the product but in general:</p><ol>
<li>Consult the documentation/vendor of the e.g. reverse proxy products that you are using and ensure that they are actively defending against the attack.</li>
<li>Configure the front-end webserver to use HTTP/2 in backend connections.</li>
<li>Configure the front-end webserver to prevent aggregation of HTTP requests from separate client-side TCP streams into the same server-side connection.</li>
<li>Use a WAF (Web Application Firewall) and ensure it has a module for thwarting request smuggling attempts</li>
</ol><p>Further reading</p><ul>
<li><a href="https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn" target="_blank" rel="noopener noreferrer">HTTP Desync Attacks: Request Smuggling Reborn</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-containers"><strong>Use containers</strong><a href="#use-containers" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-containers" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-containers">â€‹</a></h3><p>Run your application in isolation so that in the event of a breach, the attacker will not have unnecessary access to unwanted file-, system-, or network resources. So preferably use something like Kubernetes or a serverless cloud stack for deploying your application. If you are for any reason forced to use a bare server, then manually run e.g. Docker to constrain the application.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://www.docker.com/101-tutorial" target="_blank" rel="noopener noreferrer">Docker 101</a></li>
</ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="contractual-obligations"><strong>Contractual Obligations</strong><a href="#contractual-obligations" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ contractual-obligations" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ contractual-obligations">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adhere-to-data-processing-agreements-dpas"><strong>Adhere to Data Processing Agreements (DPAs):</strong><a href="#adhere-to-data-processing-agreements-dpas" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ adhere-to-data-processing-agreements-dpas" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ adhere-to-data-processing-agreements-dpas">â€‹</a></h3><p>Use customer data only for agreed purposes. Marketing, reselling, or sharing data with subcontractors requires explicit written consent. This ensures compliance with privacy laws (e.g., GDPR, CCPA) and maintains trust.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="report-breaches-within-24-hours"><strong>Report breaches within 24 hours:</strong><a href="#report-breaches-within-24-hours" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ report-breaches-within-24-hours" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ report-breaches-within-24-hours">â€‹</a></h3><p>Notify us immediately of any suspected breach, including details of affected data and steps taken for containment to us. Collaborate on forensic investigations and customer notifications. Prompt reporting minimizes reputational and legal risks.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="submit-to-annual-penetration-tests"><strong>Submit to annual penetration tests:</strong><a href="#submit-to-annual-penetration-tests" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ submit-to-annual-penetration-tests" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ submit-to-annual-penetration-tests">â€‹</a></h3><p>Conduct third-party penetration tests annually and share results with us. Critical vulnerabilities must be remediated within 30 days. This validates your systemsâ€™ resilience against real-world attacks.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="continuous-security-practices"><strong>Continuous Security Practices</strong><a href="#continuous-security-practices" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ continuous-security-practices" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ continuous-security-practices">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="conduct-continuous-vulnerability-scanning"><strong>Conduct continuous vulnerability scanning:</strong><a href="#conduct-continuous-vulnerability-scanning" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ conduct-continuous-vulnerability-scanning" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ conduct-continuous-vulnerability-scanning">â€‹</a></h3><p>Use industry-standard tools to identify unpatched software, misconfigurations, or exposed services. Critical vulnerabilities (CVSS score â‰¥7.0) must be remediated within 14 days. Proactive scanning reduces exploit risks.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitor-systems-in-real-time"><strong>Monitor systems in real time:</strong><a href="#monitor-systems-in-real-time" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ monitor-systems-in-real-time" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ monitor-systems-in-real-time">â€‹</a></h3><p>Deploy Security Information and Event Management (SIEM) tools to flag suspicious activity (e.g., repeated failed logins, unauthorized access attempts). Retain logs for at least 12 months for forensic purposes. Rapid detection enables swift incident response.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="update-security-practices-annually"><strong>Update security practices annually:</strong><a href="#update-security-practices-annually" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ update-security-practices-annually" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ update-security-practices-annually">â€‹</a></h3><p>Revise policies, tools, and training programs to address emerging threats (e.g., AI-driven phishing, zero-day exploits). Document changes and share summaries with us upon request. Cybersecurity requires ongoing adaptation to evolving risks.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="defending-web-application-threats"><strong>Defending Web Application Threats</strong><a href="#defending-web-application-threats" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ defending-web-application-threats" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ defending-web-application-threats">â€‹</a></h2><p>There are a couple of threats on the end user&#x27;s side that you as a developer can help mitigate. They include:</p><ul>
<li>Attacks through malicious websites/links in the user&#x27;s browser.</li>
<li>Attacks on the user&#x27;s local network.</li>
<li>Attacks where someone accesses a shared device before or after the user. For instance, if user data remains stored in the browser cache, other computer users could retrieve it later on.</li>
</ul><p>Let&#x27;s start our checklist with countermeasures for these threats.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-https-and-only-https-to-protect-your-users-from-network-attacks"><strong>Use HTTPS and only HTTPS to protect your users from network attacks</strong><a href="#use-https-and-only-https-to-protect-your-users-from-network-attacks" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-https-and-only-https-to-protect-your-users-from-network-attacks" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-https-and-only-https-to-protect-your-users-from-network-attacks">â€‹</a></h3><p>This one you probably already knew. Encrypt <strong>all</strong> connections between your user&#x27;s web browser and your web server. It doesn&#x27;t hurt also to disable some of the older cipher suites and protocols.<br>
<!-- -->It is <strong>not</strong> enough to encrypt the &quot;sensitive&quot; portions of a website. An attacker can intercept a single unencrypted HTTP request and then forge a response from the server with malicious content in it.<br>
<!-- -->HTTPS, which stands for Hypertext Transfer Protocol Secure, is a more secure extension of the standard HTTP protocol. HTTPS establishes an encrypted connection between a web server and a client&#x27;s browser using Transport Layer Security (TLS) or its predecessor, Secure Sockets Layer (SSL).<br>
<!-- -->By using the HTTPS protocol, you can ensure that your applications are being accessed securely. Part of this is done by restricting access to your application through HTTP and only allowing access through HTTPS. If there is an issue with an HTTPS connection, many browsers will let the user know that the site may not be secure, which helps to inform users to be cautious or even avoid the site until the security issue is fixed.<br>
<!-- -->By implementing HTTPS and proper certificate management, you can protect data in transit from man-in-the-middle attacks and interceptions. These types of attacks are easily executed over unsecure connections and networks and can be limited by using HTTPS. Many hosting solutions make it easy to deploy and maintain your applications with secure connections using the principles mentioned above.<br>
<!-- -->Luckily HTTPS is effortless these days. You can get both the certificate (LetsEncrypt) and automatic certificate creation/management (CertBot) free of charge.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://www.ssl.com/guide/ssl-best-practices/" target="_blank" rel="noopener noreferrer">SSL/TLS Best Practices for 2021</a></li>
<li><a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">LetsEncrypt</a></li>
<li><a href="https://certbot.eff.org/" target="_blank" rel="noopener noreferrer">CertBot</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-hsts-and-preloading-to-protect-your-users-from-ssl-stripping-attacks"><strong>Use HSTS and preloading to protect your users from SSL stripping attacks</strong><a href="#use-hsts-and-preloading-to-protect-your-users-from-ssl-stripping-attacks" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-hsts-and-preloading-to-protect-your-users-from-ssl-stripping-attacks" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-hsts-and-preloading-to-protect-your-users-from-ssl-stripping-attacks">â€‹</a></h3><p><a href="http://docs.google.com/blog/hsts" target="_blank" rel="noopener noreferrer">HSTS</a> or Strict-Transport-Security is a header that your server can use to enforce encrypted connections. It says, <em>from here on, always use an encrypted connection (HTTPS) connecting to my domain</em>.<br>
<!-- -->HSTS will prevent so-called <em>SSL stripping</em> attacks where an attacker on the network intercepts the very first HTTP request made by a browser (which is often unencrypted) and forges a reply to that unencrypted HTTP request right away, pretending to be the server and downgrading the connection to intercepted plaintext HTTP from then on.<br>
<!-- -->One caveat is that HSTS will only protect an application if the user has already successfully visited it before. To overcome this limitation, you should submit your site to [<a href="https://hstspreload.org%5C" target="_blank" rel="noopener noreferrer">https://hstspreload.org\</a>] (<a href="https://hstspreload.org" target="_blank" rel="noopener noreferrer">https://hstspreload.org</a>) so browser vendors can hardcode your domain to the HSTS list.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example"><strong>Example</strong><a href="#example" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ example" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ example">â€‹</a></h4><p>Strict-Transport-Security: max-age=63072000; includeSubDomains; preload</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="warning"><strong>Warning</strong><a href="#warning" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ warning" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ warning">â€‹</a></h4><p>Be mindful when implementing HSTS. It <em>will</em> force encrypted traffic to your website, and if you still have plain text, your website could break. So start with a small max-age and ramp it up once you&#x27;re confident that everything still functions properly. And leave preloading as the last step because it&#x27;s painful to cancel.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security" target="_blank" rel="noopener noreferrer">HSTS</a></li>
<li><a href="https://hstspreload.org" target="_blank" rel="noopener noreferrer">hstspreload.org</a></li>
<li><a href="https://tools.kali.org/information-gathering/sslstrip" target="_blank" rel="noopener noreferrer">sslstrip</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="serve-cookies-with-the-secure-attribute-to-protect-your-user-from-network-attacks"><strong>Serve cookies with the &#x27;Secure&#x27; attribute to protect your user from network attacks</strong><a href="#serve-cookies-with-the-secure-attribute-to-protect-your-user-from-network-attacks" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-cookies-with-the-secure-attribute-to-protect-your-user-from-network-attacks" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-cookies-with-the-secure-attribute-to-protect-your-user-from-network-attacks">â€‹</a></h3><p>Configure your cookies with the Secure attribute. This attribute will prevent them from being leaked over an (accidental or forced) unencrypted connection.<br>
<!-- -->Set-Cookie: foo=bar; ...other options... Secure</p><p>Further reading</p><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#restrict_access_to_cookies" target="_blank" rel="noopener noreferrer">Secure Cookies</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="generate-html-safely-to-avoid-xss-vulnerabilities"><strong>Generate HTML safely to avoid XSS vulnerabilities</strong><a href="#generate-html-safely-to-avoid-xss-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ generate-html-safely-to-avoid-xss-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ generate-html-safely-to-avoid-xss-vulnerabilities">â€‹</a></h3><p>To avoid XSS (Cross-Site Scripting) vulnerabilities, use one of the following:</p><ol>
<li>Completely static websites (e.g., JavaScript SPA + backend API). The most effective way to avoid problems with generating HTML is not to generate HTML at all. Try NexJS, perhaps. It&#x27;s pretty cool.</li>
<li>A template engine. Suppose you have a traditional web application where HTML is generated and parameterized on the backend server. In that case, <strong>do not</strong> craft HTML through string concatenation. Instead, use a template engine such as Twig for PHP, Thymeleaf for Java, Jinja2 for Python, and so on.</li>
</ol><p>If you use a template engine, ensure it&#x27;s configured correctly to automatically encode parameters properly, and don&#x27;t use any &quot;insecure&quot; functions that bypass the automatic encoding. And don&#x27;t put HTML in dangerous places like event handler code, unquoted attributes, or href/src.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://portswigger.net/web-security/cross-site-scripting" target="_blank" rel="noopener noreferrer">XSS Attacks &amp; Prevention</a></li>
<li><a href="https://github.com/twigphp/Twig" target="_blank" rel="noopener noreferrer">Twig</a></li>
<li><a href="https://www.thymeleaf.org/" target="_blank" rel="noopener noreferrer">Thymeleaf</a></li>
<li><a href="https://jinja2docs.readthedocs.io/en/stable/" target="_blank" rel="noopener noreferrer">Jinja2</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-javascript-safely-to-avoid-xss-vulnerabilities"><strong>Use JavaScript safely to avoid XSS vulnerabilities</strong><a href="#use-javascript-safely-to-avoid-xss-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-javascript-safely-to-avoid-xss-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-javascript-safely-to-avoid-xss-vulnerabilities">â€‹</a></h3><p>To avoid XSS (Cross-Site Scripting) vulnerabilities on the JavaScript side, don&#x27;t pass any untrusted data into functions or properties that could end up executing code. You have to use common sense here but some of the usual suspects are:</p><ul>
<li>eval, setTimeout, setInterval, etc.</li>
<li>innerHTML, React&#x27;s dangerouslySetInnerHTML, etc.</li>
<li>onClick, onMouseEnter, onError, etc.</li>
<li>href, src, etc.</li>
<li>location, location.href, etc.</li>
</ul><p>Further reading</p><ul>
<li><a href="http://docs.google.com/blog/xss-attack-and-prevention" target="_blank" rel="noopener noreferrer">XSS Attacks &amp; Prevention</a></li>
<li><a href="https://portswigger.net/web-security/cross-site-scripting/dom-based" target="_blank" rel="noopener noreferrer">DOM-based XSS</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sanitize-and-sandbox-untrusted-content-to-avoid-xss-and-other-vulnerabilities"><strong>Sanitize and sandbox untrusted content to avoid XSS and other vulnerabilities</strong><a href="#sanitize-and-sandbox-untrusted-content-to-avoid-xss-and-other-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ sanitize-and-sandbox-untrusted-content-to-avoid-xss-and-other-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ sanitize-and-sandbox-untrusted-content-to-avoid-xss-and-other-vulnerabilities">â€‹</a></h3><p>It&#x27;s best to avoid untrusted content. But sometimes, you have to retrieve raw HTML from, e.g., a remote source and then render it on your website. Or maybe you have to allow your users to write posts with a WYSIWYG editor. There are many use cases.<br>
<!-- -->To avoid XSS (Cross-Site Scripting) vulnerabilities in these scenarios, sanitize the content first with DOMPurify and then render it inside a sandboxed frame.<br>
<!-- -->Even if your WYSIWYG library claims to remove evilness from the HTML, you can break this trust relationship (&quot;I trust my WYSIWYG library to sanitize the content&quot;) by re-purifying and sandboxing the content nevertheless. The more trust relationships you break, the more secure your application gets.<br>
<!-- -->There is another common use-case, you want to display e.g. ads on the page. In this case using an IFRAME is <strong>not enough</strong> because the same-origin-policy for some reason allows cross-origin frames to change the URL of the parent frame (your website) to e.g. a phishing site. Always use the sandbox iframe attribute in these cases to prevent this.<br>
<!-- -->Further reading</p><ul>
<li><a href="http://docs.google.com/blog/xss-attack-and-prevention" target="_blank" rel="noopener noreferrer">XSS Attacks &amp; Prevention</a></li>
<li><a href="https://github.com/cure53/DOMPurify" target="_blank" rel="noopener noreferrer">DOMPurify</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-sandbox" target="_blank" rel="noopener noreferrer">Sandboxed Frames</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="implement-an-effective-content-security-policy-to-protect-your-users-from-xss-xsleak-and-other-vulnerabilities"><strong>Implement an effective Content Security Policy to protect your users from XSS, xsleak and other vulnerabilities</strong><a href="#implement-an-effective-content-security-policy-to-protect-your-users-from-xss-xsleak-and-other-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ implement-an-effective-content-security-policy-to-protect-your-users-from-xss-xsleak-and-other-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ implement-an-effective-content-security-policy-to-protect-your-users-from-xss-xsleak-and-other-vulnerabilities">â€‹</a></h3><p>A <a href="http://docs.google.com/blog/content-security-policy-header" target="_blank" rel="noopener noreferrer">Content Security Policy (CSP)</a> serves as excellent protection against XSS (Cross-Site Scripting) attacks. It also protects against clickjacking attacks, among other things.<br>
<!-- -->So make sure to use it! CSP, by default, prevents pretty much everything, so the fewer things you put in it, the better. For example, the following is a good policy to start with:<br>
<!-- -->Content-Security-Policy: default-src &#x27;self&#x27;; form-action &#x27;self&#x27;; object-src &#x27;none&#x27;</p><p>It allows loading scripts, styles, images, fonts, etc., from the web application&#x27;s origin but nothing else. Most notably, it will prevent inline scripts (&lt;script&gt;...&lt;/script&gt;), which makes exploiting XSS vulnerabilities difficult.<br>
<!-- -->Additionally, the form-action: &#x27;self&#x27; directive prevents creating malicious HTML forms on the website (think &quot;Your session has expired, please enter your password here&quot;) and submitting them to the attacker&#x27;s server.<br>
<!-- -->Whatever you do, do not specify <strong>script-src: unsafe-inline</strong> because then your CSP will lose its mojo.<br>
<!-- -->And finally, if you have concerns about CSP breaking something in production, you can first deploy in Report-Only mode:<br>
<!-- -->Content-Security-Policy-Report-Only: default-src &#x27;self&#x27;; form-action &#x27;self&#x27;</p><p>Further reading</p><ul>
<li><a href="https://portswigger.net/web-security/cross-site-scripting" target="_blank" rel="noopener noreferrer">XSS Attacks &amp; Prevention</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP" target="_blank" rel="noopener noreferrer">Content Security Policy</a></li>
<li><a href="http://docs.google.com/blog/clickjacking" target="_blank" rel="noopener noreferrer">Clickjacking Attacks</a></li>
<li><a href="http://docs.google.com/blog/xs-leaks" target="_blank" rel="noopener noreferrer">XS-Leaks</a></li>
<li><a href="https://xsleaks.dev/" target="_blank" rel="noopener noreferrer">XS-Leaks Wiki</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="serve-cookies-with-the-httponly-attribute-to-protect-them-from-xss-attacks"><strong>Serve cookies with the HttpOnly attribute to protect them from XSS attacks</strong><a href="#serve-cookies-with-the-httponly-attribute-to-protect-them-from-xss-attacks" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-cookies-with-the-httponly-attribute-to-protect-them-from-xss-attacks" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-cookies-with-the-httponly-attribute-to-protect-them-from-xss-attacks">â€‹</a></h3><p>Configure your cookies with the HttpOnly attribute. This attribute will prevent them from being accessed by JavaScript code. And this makes them more challenging for an attacker to steal in the event of a successful XSS (Cross-Site Scripting) attack. Of course, you cannot do this for the cookies that need to be accessed by JavaScript.<br>
<!-- -->Set-Cookie: foo=bar; ...other options... HttpOnly</p><p>Further reading</p><ul>
<li><a href="https://portswigger.net/web-security/cross-site-scripting" target="_blank" rel="noopener noreferrer">XSS Attacks &amp; Prevention</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#restrict_access_to_cookies" target="_blank" rel="noopener noreferrer">HttpOnly</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="serve-downloads-with-a-proper-content-disposition-header-to-avoid-xss-vulnerabilities"><strong>Serve downloads with a proper Content-Disposition header to avoid XSS vulnerabilities</strong><a href="#serve-downloads-with-a-proper-content-disposition-header-to-avoid-xss-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-downloads-with-a-proper-content-disposition-header-to-avoid-xss-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-downloads-with-a-proper-content-disposition-header-to-avoid-xss-vulnerabilities">â€‹</a></h3><p>To avoid XSS (Cross-Site Scripting) vulnerabilities when serving downloads to your users, send them with a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition" target="_blank" rel="noopener noreferrer">Content-Disposition</a> header that indicates an attachment. This way, the file won&#x27;t render in the end user&#x27;s browser directly, resulting in an XSS vulnerability in the case of, e.g., HTML or SVG files.<br>
<!-- -->Content-Disposition: attachment; filename=&quot;document.pdf&quot;</p><p>Suppose you <em>want</em> some specific files to open in the browser (like perhaps PDF documents for usability reasons), and you know that it&#x27;s safe to do so. In that case, you can omit the header or change attachment to inline for that particular file extension/extensions.<br>
<!-- -->Further reading</p><ul>
<li><a href="http://docs.google.com/blog/xss-attack-and-prevention" target="_blank" rel="noopener noreferrer">XSS Attacks &amp; Prevention</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition" target="_blank" rel="noopener noreferrer">Content-Disposition</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="serve-api-responses-with-a-proper-content-disposition-header-to-avoid-reflected-download-vulnerabilities"><strong>Serve API responses with a proper Content-Disposition header to avoid reflected download vulnerabilities</strong><a href="#serve-api-responses-with-a-proper-content-disposition-header-to-avoid-reflected-download-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-api-responses-with-a-proper-content-disposition-header-to-avoid-reflected-download-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-api-responses-with-a-proper-content-disposition-header-to-avoid-reflected-download-vulnerabilities">â€‹</a></h3><p>An attack called reflected file download (RFD) works by crafting a URL that downloads as a malicious file extension from your API, reflecting a malicious payload inside it.<br>
<!-- -->You can prevent this attack by returning a Content-Disposition header with a safe filename in your API HTTP responses.<br>
<!-- -->Content-Disposition: attachment; filename=&quot;api.json&quot;</p><p>Further reading</p><ul>
<li><a href="https://medium.com/@Johne_Jacob/rfd-reflected-file-download-what-how-6d0e6fdbe331" target="_blank" rel="noopener noreferrer">Reflected File Download</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition" target="_blank" rel="noopener noreferrer">Content-Disposition</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-your-platforms-anti-csrf-mechanism-to-avoid-csrf-vulnerabilities"><strong>Use your platform&#x27;s anti-CSRF mechanism to avoid CSRF vulnerabilities</strong><a href="#use-your-platforms-anti-csrf-mechanism-to-avoid-csrf-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-your-platforms-anti-csrf-mechanism-to-avoid-csrf-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-your-platforms-anti-csrf-mechanism-to-avoid-csrf-vulnerabilities">â€‹</a></h3><p>To protect against <a href="https://owasp.org/www-community/attacks/csrf" target="_blank" rel="noopener noreferrer">Cross-Site Request Forgery</a> (CSRF) vulnerabilities, ensure that your platform&#x27;s anti-CSRF mechanism is enabled and working as intended.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://www.guardrails.io/blog/what-is-csrf-and-how-do-you-prevent-it/" target="_blank" rel="noopener noreferrer">CSRF Attacks &amp; Prevention</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="validate-the-oauthoidc-state-parameter-to-avoid-csrf-vulnerabilities"><strong>Validate the OAuth/OIDC state parameter to avoid CSRF vulnerabilities</strong><a href="#validate-the-oauthoidc-state-parameter-to-avoid-csrf-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ validate-the-oauthoidc-state-parameter-to-avoid-csrf-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ validate-the-oauthoidc-state-parameter-to-avoid-csrf-vulnerabilities">â€‹</a></h3><p>There is a CSRF attack related to OAuth/OIDC where the attacker unwittingly logs the user in with the attacker&#x27;s account. If you are using OAuth/OIDC, make sure that your library is validating the state parameter.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://tools.ietf.org/html/rfc6819#section-4.4.2.5" target="_blank" rel="noopener noreferrer">state CSRF in OAuth threat model</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-http-verbs-properly-to-avoid-csrf-vulnerabilities"><strong>Use HTTP verbs properly to avoid CSRF vulnerabilities</strong><a href="#use-http-verbs-properly-to-avoid-csrf-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-http-verbs-properly-to-avoid-csrf-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-http-verbs-properly-to-avoid-csrf-vulnerabilities">â€‹</a></h3><p>Never use anything except for POST, PUT, PATCH or DELETE for making <em>any</em> changes. GET requests, for example, are usually not covered by anti-CSRF mechanisms.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://www.guardrails.io/blog/what-is-csrf-and-how-do-you-prevent-it/" target="_blank" rel="noopener noreferrer">CSRF Attacks &amp; Prevention</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="serve-cookies-with-the-samesite-attribute-to-protect-your-users-from-csrf-vulnerabilities-xsleaks-and-sometimes-xss-as-well"><strong>Serve cookies with the SameSite attribute to protect your users from CSRF vulnerabilities, xsleaks and sometimes XSS as well</strong><a href="#serve-cookies-with-the-samesite-attribute-to-protect-your-users-from-csrf-vulnerabilities-xsleaks-and-sometimes-xss-as-well" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-cookies-with-the-samesite-attribute-to-protect-your-users-from-csrf-vulnerabilities-xsleaks-and-sometimes-xss-as-well" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-cookies-with-the-samesite-attribute-to-protect-your-users-from-csrf-vulnerabilities-xsleaks-and-sometimes-xss-as-well">â€‹</a></h3><p>Configure your cookies with the <a href="https://owasp.org/www-community/SameSite" target="_blank" rel="noopener noreferrer">SameSite</a> attribute. SameSite will prevent most <a href="https://www.guardrails.io/blog/what-is-csrf-and-how-do-you-prevent-it/" target="_blank" rel="noopener noreferrer">CSRF</a> (Cross-Site Request Forgery) attacks, where a malicious website submits e.g., a form on behalf of your unwitting user.<br>
<!-- -->There are two modes, Lax and Strict.<br>
<!-- -->The Lax mode is just fine for preventing most cross-site timing and CSRF attacks, except GET-based CSRF vulnerabilities where you make the mistake of making changes (e.g., modifying some database record) in a GET request handler. The Strict mode prevents that sort of blunders from being exploited as well.<br>
<!-- -->However, the Strict mode has another powerful side effect; it makes reflected XSS (Cross-Site Scripting) vulnerabilities practically impossible to exploit as well.<br>
<!-- -->The Strict mode is not well suited for most applications because it breaks authenticated links. If your user is logged in and opens a link on another website to the application, then the tab/window that opens will not be logged in for the user. The session cookie doesn&#x27;t tag along with the request due to the strict mode.<br>
<!-- -->But at least implement SameSite in Lax mode, there&#x27;s no harm in doing so, and it serves as an excellent safeguard against CSRF and cross-site timing attacks.<br>
<!-- -->Set-Cookie: foo=bar; ...other options... SameSite=Lax</p><p>...or:<br>
<!-- -->Set-Cookie: foo=bar; ...other options... SameSite=Strict</p><p>Further reading</p><ul>
<li><a href="https://www.guardrails.io/blog/what-is-csrf-and-how-do-you-prevent-it/" target="_blank" rel="noopener noreferrer">CSRF Attacks &amp; Prevention</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite" target="_blank" rel="noopener noreferrer">SameSite cookies</a></li>
<li><a href="https://xsleaks.dev/" target="_blank" rel="noopener noreferrer">XS-Leaks Wiki</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-fresh-session-id-on-login-to-protect-against-session-fixation-attacks"><strong>Create a fresh session ID on login to protect against session fixation attacks</strong><a href="#create-a-fresh-session-id-on-login-to-protect-against-session-fixation-attacks" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ create-a-fresh-session-id-on-login-to-protect-against-session-fixation-attacks" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ create-a-fresh-session-id-on-login-to-protect-against-session-fixation-attacks">â€‹</a></h3><p>Next on our checklist is session fixation attacks. Here is how they might work:</p><ol>
<li>An attacker injects a cookie, say, JSESSIONID=ABC123 into your user&#x27;s browser. There are many ways the attacker can go about this.</li>
<li>Your user logs in with their credentials, submitting the attacker&#x27;s chosen JSESSIONID=ABC123 cookie in the login request.</li>
<li>Your application authenticates the cookie, and the user is authenticated from that point onwards.</li>
<li><strong>The attacker who also has the cookie is also logged on as the user from that point onwards</strong>.</li>
</ol><p>To prevent this, create a new, authenticated session ID and return it to the user instead of authenticating the existing cookie that might be compromised.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://owasp.org/www-community/attacks/Session_fixation" target="_blank" rel="noopener noreferrer">Session Fixation</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="name-your-cookies-right-to-protect-against-session-fixation-attacks"><strong>Name your cookies right to protect against session fixation attacks</strong><a href="#name-your-cookies-right-to-protect-against-session-fixation-attacks" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ name-your-cookies-right-to-protect-against-session-fixation-attacks" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ name-your-cookies-right-to-protect-against-session-fixation-attacks">â€‹</a></h3><p>You didn&#x27;t expect to find cookie naming in an application security checklist, did you? This is not very widely known, but when it comes to cookies, name matters! Name your cookies __Host-Something and web browsers will...</p><ol>
<li>Not allow for the cookie to be set over an unencrypted connection which protects against session fixation attacks and other threats related to an attacker forcing a cookie into the user&#x27;s browser.</li>
<li>Not allow for subdomains to overwrite the cookie, which protects against similar attacks from compromised/malicious subdomains.</li>
</ol><p>Set-Cookie: __Host-foo=bar ...options...</p><p>Further reading</p><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#cookie_prefixes" target="_blank" rel="noopener noreferrer">Cookie Prefixes</a></li>
<li><a href="https://owasp.org/www-community/attacks/Session_fixation" target="_blank" rel="noopener noreferrer">Session Fixation</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="serve-proper-cache-control-headers-to-protect-your-users-data-from-subsequent-computer-users"><strong>Serve proper Cache-Control headers to protect your user&#x27;s data from subsequent computer users</strong><a href="#serve-proper-cache-control-headers-to-protect-your-users-data-from-subsequent-computer-users" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-proper-cache-control-headers-to-protect-your-users-data-from-subsequent-computer-users" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-proper-cache-control-headers-to-protect-your-users-data-from-subsequent-computer-users">â€‹</a></h3><p>By default, web browsers cache everything they see to speed up page loads and save network bandwidth.<br>
<!-- -->Caching is a synonym for <em>storing visited websites and downloaded files on disk unencrypted until someone manually deletes them</em>.<br>
<!-- -->The users of your application should be able to trust that once they log out, they are logged out, and they can safely leave the (e.g., library) computer.<br>
<!-- -->For this reason, there is a header called Cache-Control which you should return appropriately in all HTTP responses that contain non-public/non-static content.<br>
<!-- -->Cache-Control: no-store, max-age=0</p><p>Further reading <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control" target="_blank" rel="noopener noreferrer">Cache-Control</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="serve-a-clear-site-data-header-upon-log-out-to-protect-your-users-data-from-subsequent-computer-users"><strong>Serve a Clear-Site-Data header upon log out to protect your user&#x27;s data from subsequent computer users</strong><a href="#serve-a-clear-site-data-header-upon-log-out-to-protect-your-users-data-from-subsequent-computer-users" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-a-clear-site-data-header-upon-log-out-to-protect-your-users-data-from-subsequent-computer-users" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ serve-a-clear-site-data-header-upon-log-out-to-protect-your-users-data-from-subsequent-computer-users">â€‹</a></h3><p>Another useful header for ensuring that user data gets cleared upon logout is the new Clear-Site-Data header. You can send it in an HTTP response when the user logs out. The browser will clear the cache, cookies, storage, and execution contexts (this is not yet implemented at the time of this writing) for the domain. Most browsers support it; Safari notably still doesn&#x27;t.<br>
<!-- -->You can send it as follows:<br>
<!-- -->Clear-Site-Data: &#x27;*&#x27;</p><p>Further reading <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Clear-Site-Data" target="_blank" rel="noopener noreferrer">Clear-Site-Data</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-your-users-out-properly-to-protect-their-data-from-subsequent-computer-users"><strong>Log your users out properly to protect their data from subsequent computer users</strong><a href="#log-your-users-out-properly-to-protect-their-data-from-subsequent-computer-users" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ log-your-users-out-properly-to-protect-their-data-from-subsequent-computer-users" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ log-your-users-out-properly-to-protect-their-data-from-subsequent-computer-users">â€‹</a></h3><p>Ensure that logging out invalidates the access token/session identifier. It should no longer be usable if it later leaks to an attacker from browsing history/cache/memory/etc.<br>
<!-- -->Additionally, if there is an SSO, don&#x27;t forget to call the single logout endpoint correctly. Otherwise, logging out would be in vain since merely clicking the &quot;log in&quot; button would automatically log the user back as the SSO session is still active.<br>
<!-- -->Finally, clear any cookies, HTML5 storage, etc., that you might have used. The Clear-Site-Data mentioned above is not yet supported by, e.g., Safari, so you will have to clear the data manually as well.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-sessionstorage-for-javascript-secrets-to-protect-your-users-data-from-subsequent-computer-users"><strong>Use SessionStorage for JavaScript secrets to protect your user&#x27;s data from subsequent computer users</strong><a href="#use-sessionstorage-for-javascript-secrets-to-protect-your-users-data-from-subsequent-computer-users" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-sessionstorage-for-javascript-secrets-to-protect-your-users-data-from-subsequent-computer-users" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-sessionstorage-for-javascript-secrets-to-protect-your-users-data-from-subsequent-computer-users">â€‹</a></h3><p>It&#x27;s like LocalStorage but unique for each tab and clears after the browser/tab is closed. So there&#x27;s a chance of user data leaking to the next computer user.<br>
<strong>Note</strong> If you want to have your user authenticated in multiple tabs of your application without logging in again, you will have to use events to sync the sessionStorage between the tabs.<br>
<!-- -->Further reading <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage" target="_blank" rel="noopener noreferrer">Session Storage</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dont-transmit-sensitive-data-in-the-url-because-urls-are-not-designed-to-be-secret"><strong>Don&#x27;t transmit sensitive data in the URL because URLs are not designed to be secret</strong><a href="#dont-transmit-sensitive-data-in-the-url-because-urls-are-not-designed-to-be-secret" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ dont-transmit-sensitive-data-in-the-url-because-urls-are-not-designed-to-be-secret" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ dont-transmit-sensitive-data-in-the-url-because-urls-are-not-designed-to-be-secret">â€‹</a></h3><p>URL addresses are not designed to be secret. They are, for example, displayed on the screen, saved to browsing history, leaked with referrer-headers, and saved on server logs. So don&#x27;t put secrets in there.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-a-referrer-policy-to-prevent-url-addresses-from-leaking-to-other-websites"><strong>Use a referrer policy to prevent URL addresses from leaking to other websites</strong><a href="#use-a-referrer-policy-to-prevent-url-addresses-from-leaking-to-other-websites" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-a-referrer-policy-to-prevent-url-addresses-from-leaking-to-other-websites" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-a-referrer-policy-to-prevent-url-addresses-from-leaking-to-other-websites">â€‹</a></h3><p>Next on our checklist: referrer policies. By default, when you link to a website from your application, and a user clicks the link, web browsers will send a Referrer header to tell the website which website is linked to it. This header includes the entire URL, which can be a privacy issue at the least.<br>
<!-- -->You can disable this behavior by specifying a Referrer-Policy header in your HTTP responses:<br>
<!-- -->Referrer-Policy: no-referrer</p><p>Further reading</p><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy" target="_blank" rel="noopener noreferrer">Referrer-Policy</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-a-unique-domain-name-for-your-application-to-protect-it-from-other-applications-under-the-same-origin-and-vice-versa"><strong>Use a unique domain name for your application to protect it from other applications under the same origin (and vice versa)</strong><a href="#use-a-unique-domain-name-for-your-application-to-protect-it-from-other-applications-under-the-same-origin-and-vice-versa" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-a-unique-domain-name-for-your-application-to-protect-it-from-other-applications-under-the-same-origin-and-vice-versa" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-a-unique-domain-name-for-your-application-to-protect-it-from-other-applications-under-the-same-origin-and-vice-versa">â€‹</a></h3><p>It is dangerous to host applications like this: <a href="https://www.example.com/app1/" target="_blank" rel="noopener noreferrer">https://www.example.com/app1/</a> and <a href="https://www.example.com/app2/" target="_blank" rel="noopener noreferrer">https://www.example.com/app2/</a>. Browsers consider both of them to be of the same origin, that is, same host, port, and scheme. And being of the same origin, they will have full access to each other. Any vulnerabilities/malicious content affecting app1 will also put app2 in danger.<br>
<!-- -->For this reason, give each application an origin of their own. So the solution could be <a href="https://app1.example.com/" target="_blank" rel="noopener noreferrer">https://app1.example.com/</a> and <a href="https://app2.example.com/" target="_blank" rel="noopener noreferrer">https://app2.example.com/</a>.<br>
<strong>Note</strong> Subdomains that share a parent can still <em>set</em> cookies for the entire domain. For example, app1.example.com can set a cookie on example.com which will then also be sent to app2.example.com. Being able to set cookies for a website will sometimes make attacks such as session fixation possible.<br>
<!-- -->And if you are now wondering if all applications under <em>.herokuapp.com are vulnerable, the answer is no because of the public suffix list. Also, you can protect cookies from getting overwritten by subdomains by naming your cookies `__Host-</em>`.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://web.dev/articles/same-origin-policy" target="_blank" rel="noopener noreferrer">Same Origin Policy</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#cookie_prefixes" target="_blank" rel="noopener noreferrer">Cookie Prefixes</a></li>
<li><a href="https://owasp.org/www-community/attacks/Session_fixation" target="_blank" rel="noopener noreferrer">Session Fixation</a></li>
<li><a href="https://publicsuffix.org/learn/" target="_blank" rel="noopener noreferrer">Public Suffix List</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dont-use-cors-unless-you-have-to-and-if-you-have-to-be-careful-with-it"><strong>Don&#x27;t use CORS unless you have to, and if you have to, be careful with it</strong><a href="#dont-use-cors-unless-you-have-to-and-if-you-have-to-be-careful-with-it" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ dont-use-cors-unless-you-have-to-and-if-you-have-to-be-careful-with-it" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ dont-use-cors-unless-you-have-to-and-if-you-have-to-be-careful-with-it">â€‹</a></h3><p>The web browser&#x27;s security model is largely based on the <a href="https://web.dev/articles/same-origin-policy" target="_blank" rel="noopener noreferrer">Same Origin Policy</a> which prevents evil.example.com from reading your emails but still allows you to use jQuery from code.jquery.com. CORS or <a href="https://www.appsecmonkey.com/blog/cors/" target="_blank" rel="noopener noreferrer">Cross Origin Resource Sharing</a> is a means by which you can allow another website to violate that policy.<br>
<!-- -->So if you decide that you need it, make sure you know what you are doing.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://www.appsecmonkey.com/blog/cors/" target="_blank" rel="noopener noreferrer">Cross-Origin Resource Sharing</a></li>
</ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="validate-the-origin"><strong>Validate the origin</strong><a href="#validate-the-origin" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ validate-the-origin" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ validate-the-origin">â€‹</a></h4><p>If you have api.example.com that needs to be accessed by GET requests from <a href="http://www.example.com" target="_blank" rel="noopener noreferrer">www.example.com</a> then you can specify the following header on api.example.com:<br>
<!-- -->Access-Control-Allow-Origin: <a href="https://www.example.com" target="_blank" rel="noopener noreferrer">https://www.example.com</a></p><p>If you have a public API (let&#x27;s say a calculator that you want the entire Internet to use from client-side JavaScript), then you can specify a wildcard origin:<br>
<!-- -->Access-Control-Allow-Origin: *</p><p>If you have multiple domains that you want to allow but not all (say you want to allow only Google and Facebook to access your API) then you will have to read the Origin header from the request, compare it to a list of allowed domains and then return a header as appropriate. It is recommended to use a well-vetted library for this instead of messing with the headers manually because a lot could go wrong.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="be-mindful-about-the-allow-credentials-option"><strong>Be mindful about the &quot;allow credentials&quot; option</strong><a href="#be-mindful-about-the-allow-credentials-option" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ be-mindful-about-the-allow-credentials-option" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ be-mindful-about-the-allow-credentials-option">â€‹</a></h4><p>CORS, by default, does not allow <em>credentialed</em> requests, that is, requests that carry the user&#x27;s (session) cookies. But this can be allowed by the web server by specifying headers such as:<br>
<!-- -->Access-Control-Allow-Origin: <a href="https://www.example.com" target="_blank" rel="noopener noreferrer">https://www.example.com</a><br>
<!-- -->Access-Control-Allow-Credentials: true</p><p>This set of CORS headers is dangerous as it would allow <a href="https://www.example.com" target="_blank" rel="noopener noreferrer">https://www.example.com</a> to fully access the website that specified the header just as the logged-in user would. So if you have to use it, be very careful.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="validate-the-method"><strong>Validate the method</strong><a href="#validate-the-method" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ validate-the-method" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ validate-the-method">â€‹</a></h4><p>It&#x27;s a good practice to minimize the attack surface and only allow the HTTP methods you need.<br>
<!-- -->Access-Control-Allow-Methods: GET</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="note"><strong>Note</strong><a href="#note" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ note" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ note">â€‹</a></h4><p>If you don&#x27;t need CORS, then don&#x27;t use it. By default, it&#x27;s disabled.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" target="_blank" rel="noopener noreferrer">Cross-Origin Resource Sharing</a></li>
<li><a href="https://web.dev/articles/same-origin-policy" target="_blank" rel="noopener noreferrer">Same Origin Policy</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-websockets-properly-to-avoid-csrf-and-other-vulnerabilities"><strong>Use WebSockets properly to avoid CSRF and other vulnerabilities</strong><a href="#use-websockets-properly-to-avoid-csrf-and-other-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-websockets-properly-to-avoid-csrf-and-other-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-websockets-properly-to-avoid-csrf-and-other-vulnerabilities">â€‹</a></h3><p>Next on the checklist: WebSockets. WebSockets are still pretty new, a bit scarcely documented, and there are dangers involved when using them. So read the following carefully.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-encrypt-the-connection"><strong>1. Encrypt the connection</strong><a href="#1-encrypt-the-connection" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ 1-encrypt-the-connection" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ 1-encrypt-the-connection">â€‹</a></h4><p>Just like you should use https:// instead of http://, use wss:// instead of ws:///.<br>
<!-- -->HSTS also affects WebSockets and will automatically upgrade unencrypted WebSocket connections to wss://! Hail HSTS.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-authenticate-the-connection"><strong>2. Authenticate the connection</strong><a href="#2-authenticate-the-connection" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ 2-authenticate-the-connection" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ 2-authenticate-the-connection">â€‹</a></h4><p>If you use cookie-based authentication and the WebSocket server is on the same domain as the application, you can keep using the existing session for the WebSocket connection. <strong>Just heed the next section about origin validation, or you will be screwed</strong>.<br>
<!-- -->If not, you could create a ticket in the application, that is, a single-use, time-limited authentication token bound to the user&#x27;s IP address that can authenticate the WebSocket connection.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-verify-the-origin-of-the-connection"><strong>3. Verify the origin of the connection</strong><a href="#3-verify-the-origin-of-the-connection" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ 3-verify-the-origin-of-the-connection" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ 3-verify-the-origin-of-the-connection">â€‹</a></h4><p>A crucial thing to understand about WebSockets is that the Same Origin Policy does not bind them. Any website out there can open a WebSocket connection to your application, and if you use cookie-based authentication, access the logged-in user&#x27;s information.<br>
<!-- -->For this reason, you must verify the origin of the connection in the WebSocket handshake. You can do this by validating the Origin request header.<br>
<!-- -->If you want double security, throw in a CSRF token as a URL parameter. But create a single-use unique token for the job, do not use the CSRF token that you use to secure the rest of the application (because sending something in the URL can leak in many places).<br>
<!-- -->Further reading</p><ul>
<li><a href="https://datatracker.ietf.org/doc/rfc6455/?include_text=1" target="_blank" rel="noopener noreferrer">WebSockets Specification (check section 10)</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="implement-protections-against-cross-site-leaks"><strong>Implement protections against cross-site leaks</strong><a href="#implement-protections-against-cross-site-leaks" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ implement-protections-against-cross-site-leaks" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ implement-protections-against-cross-site-leaks">â€‹</a></h3><p>XS-Leaks (or Cross-Site Leaks) are a <a href="https://xsleaks.dev/" target="_blank" rel="noopener noreferrer">set of browser side-channel attacks</a>. They enable malicious websites to infer data from the users of other web applications.<br>
<!-- -->The attacks have been there for a long time, but browsers have only recently started adding new mechanisms to prevent them. Defending Threats On Server Side - Application</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="validate-input-properly-to-protect-your-application-from-so-so-many-vulnerabilities"><strong>Validate input properly to protect your application from so, so many vulnerabilities</strong><a href="#validate-input-properly-to-protect-your-application-from-so-so-many-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ validate-input-properly-to-protect-your-application-from-so-so-many-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ validate-input-properly-to-protect-your-application-from-so-so-many-vulnerabilities">â€‹</a></h3><p>One of the most critical things on this checklist: Validate all input as strictly as you can. Proper validation will make many vulnerabilities challenging to find and exploit. Reject invalid input, do not sanitize it.</p><ul>
<li>Use restrictive data types. DateTime for dates, Integer for numbers, and so on. Use Enums for lists of possible values. Avoid using String when you can.</li>
<li>When you do have to use String, put a length limit to it if you can.</li>
<li>When you do have to use String, restrict the character set to the minimum.</li>
<li>If you process JSON, use a JSON schema.</li>
<li>If you process XML, use an XML schema.</li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="catch-exceptions-gracefully-to-avoid-leaking-technical-details"><strong>Catch exceptions gracefully to avoid leaking technical details</strong><a href="#catch-exceptions-gracefully-to-avoid-leaking-technical-details" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ catch-exceptions-gracefully-to-avoid-leaking-technical-details" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ catch-exceptions-gracefully-to-avoid-leaking-technical-details">â€‹</a></h3><p>Never show stack traces or similar debugging information to end-users. Have a global exception handler ready that catches otherwise unhandled exceptions and displays a generic error message to the browser. This will make it more difficult for an attacker to find and exploit vulnerabilities in your application.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dont-do-authentication-yourself"><strong>Don&#x27;t do authentication yourself</strong><a href="#dont-do-authentication-yourself" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ dont-do-authentication-yourself" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ dont-do-authentication-yourself">â€‹</a></h3><ul>
<li>User Divar Authentication</li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-strict-access-controls-to-prevent-unauthorized-access-to-data-or-functionality"><strong>Use strict access controls to prevent unauthorized access to data or functionality</strong><a href="#use-strict-access-controls-to-prevent-unauthorized-access-to-data-or-functionality" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-strict-access-controls-to-prevent-unauthorized-access-to-data-or-functionality" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-strict-access-controls-to-prevent-unauthorized-access-to-data-or-functionality">â€‹</a></h3><p>Access control is not always easy, but you can do it right. Just be centralized about it to not end up with an IDOR (Insecure Direct Object Reference) vulnerability because you forgot to check the user&#x27;s access in some individual controller function.</p><ul>
<li>Prevent access to all controller methods (or equivalent) by default.</li>
<li>Allow access to individual controllers by role.</li>
<li>Use method level security also to restrict access to e.g. service functions.</li>
<li>Use a centralized permission evaluator to prevent unauthorized access to individual records.</li>
<li>Use a centralized permission evaluator to filter objects returned to the client.</li>
<li>Use an architecture with, e.g., a frontend web app and a backend API, then implement the same access controls in every app/API, not just the Internet-facing parts.</li>
</ul><p>To clarify the permission evaluator approach a little bit, here&#x27;s the crux of it:</p><ul>
<li>Your data records extend a class that has some property that you use for access control. For example, int ownerId.</li>
<li>Your authenticated user has an ID.</li>
<li>You have a permission evaluator class, which knows that users can access objects if the object&#x27;s ownerId equals the user&#x27;s id.</li>
<li>You then plug that permission evaluator into your application platform&#x27;s access control system.</li>
<li>If you need more complex access control than ownerId or similar, then you can setup (for example) a complete ACL system.</li>
</ul><p>To ensure proper authorization, consider the following:</p><ul>
<li>Role-Based Access Control (RBAC): Implement a role-based access control system that assigns roles to users and specifies what actions each role is allowed to perform.</li>
<li>Least Privilege Principle: Users should have the minimum level of access required to perform their tasks, reducing the risk of unauthorized actions.</li>
<li>Session Management: Use secure session management to ensure that users are only authorized during their active sessions.</li>
<li>Audit Trails: Maintain audit logs to track and review authorization activities, enabling the detection of suspicious or unauthorized access.</li>
</ul><p>Further reading</p><ul>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html" target="_blank" rel="noopener noreferrer">Insecure Direct Object References</a></li>
<li><a href="https://www.baeldung.com/spring-deny-access" target="_blank" rel="noopener noreferrer">Deny access by default (Spring Security))</a></li>
<li><a href="https://www.baeldung.com/spring-security-method-security#3-using-preauthorize-and-postauthorize-annotations" target="_blank" rel="noopener noreferrer">PreAuthorize &amp; PostAuthorize (Spring Security)</a></li>
<li><a href="https://www.baeldung.com/spring-security-prefilter-postfilter#writing-security-rules" target="_blank" rel="noopener noreferrer">PreFilter &amp; PostFilter (Spring Security)</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-proper-tools-and-techniques-to-avoid-injection-vulnerabilities"><strong>Use proper tools and techniques to avoid injection vulnerabilities</strong><a href="#use-proper-tools-and-techniques-to-avoid-injection-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-proper-tools-and-techniques-to-avoid-injection-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-proper-tools-and-techniques-to-avoid-injection-vulnerabilities">â€‹</a></h3><p>Multiple vulnerabilities fall under the category &quot;injection&quot;, and they&#x27;re all alike. These include SQL injection, HTML injection (a form of XSS), XML injection, XPath injection, command injection, template injection, SMTP injection, response header injection... there are so many &quot;different&quot; vulnerabilities that are, in reality, the same issue with the same remedy:</p><ul>
<li>Issue: Using string concatenation/formatting to construct a parameterized message of protocol X.</li>
<li>Solution: Use a proper, well (security) tested software library for the job and use it properly.</li>
</ul><p>We won&#x27;t go through each of the injection vulnerabilities in this article since the list would be infinite, so just remember this rule whatever protocol you&#x27;re constructing. We&#x27;ll cover some of the more prevalent/interesting ones, such as SQL injection, next on our checklist.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="construct-database-queries-safely-to-avoid-sql-injection-vulnerabilities"><strong>Construct database queries safely to avoid SQL injection vulnerabilities</strong><a href="#construct-database-queries-safely-to-avoid-sql-injection-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ construct-database-queries-safely-to-avoid-sql-injection-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ construct-database-queries-safely-to-avoid-sql-injection-vulnerabilities">â€‹</a></h3><p>To avoid SQL Injection vulnerabilities, never construct SQL queries by string concatenation. Use an ORM (Object Relational Mapper) if you can. An ORM will make development quicker and the application more secure.<br>
<!-- -->If you want to have granular control over your queries, use a low-level ORM (often referred to as a query builder).<br>
<!-- -->If you cannot use an ORM, then go for prepared statements, but be careful as they are far more prone to human error than an ORM.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="warning-1"><strong>Warning</strong><a href="#warning-1" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ warning-1" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ warning-1">â€‹</a></h4><p>ORM frameworks are not a silver bullet in two senses.<br>
<!-- -->First is that they still have functionality for supporting raw SQL queries/parts of queries. Just don&#x27;t use those features, and you&#x27;re golden.<br>
<!-- -->The second is that ORM frameworks have vulnerabilities from time to time, just like any other software package. So follow other good practices: validate all input, use a WAF and keep your packages up to date, and you&#x27;re good to go.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://www.indusface.com/blog/how-to-stop-sql-injection/" target="_blank" rel="noopener noreferrer">SQL Injection Attacks &amp; Prevention</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="do-not-run-os-commands"><strong>Do not run OS commands</strong><a href="#do-not-run-os-commands" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ do-not-run-os-commands" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ do-not-run-os-commands">â€‹</a></h3><p>If you can avoid it, don&#x27;t execute OS commands at all. It&#x27;s always a bit dodgy.<br>
<!-- -->If you have to do it, you can avoid command injection vulnerabilities and related issues by following these guidelines:</p><ul>
<li>Use a proper library/function to construct and parameterize the command. The parameters should be of the list data type. Never create the command as a single string.</li>
<li>Do not use a shell to invoke the command.</li>
<li>Predetermine the parameters that you feed into the command. Using curl as an example, by allowing the user to specify the -o parameter, you would allow the attacker to write to the local filesystem.</li>
<li>Understand what the program does and validate the parameters appropriately. Again using curl as the example, you might want to allow the user to retrieve websites such as <a href="https://www.appsecmonkey.com/" target="_blank" rel="noopener noreferrer">https://www.appsecmonkey.com/</a> but what if the attacker retrieves file:///etc/passwd instead?</li>
<li>Think through. Even if you validate that the parameter starts with http:// or https://, would you like for the attacker to access <a href="http://192.168.0.1/internal%5C_sensitive%5C_service/admin" target="_blank" rel="noopener noreferrer">http://192.168.0.1/internal\_sensitive\_service/admin</a> or do a port scan of the internal network?</li>
<li><strong>Really</strong> think through. Even if you validate that the parameter is a valid DNS hostname that doesn&#x27;t contain e.g. yourcompany.local, is there anything preventing the attacker from creating a public DNS record that points <a href="http://www.example.com" target="_blank" rel="noopener noreferrer">www.example.com</a> to 192.168.0.1? The answer is... no. It can be done.</li>
</ul><p>Further reading</p><ul>
<li><a href="https://owasp.org/www-community/attacks/Command_Injection" target="_blank" rel="noopener noreferrer">Command Injection</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="avoid-xml-vulnerabilities-by-configuring-your-parsers-properly"><strong>Avoid XML vulnerabilities by configuring your parsers properly</strong><a href="#avoid-xml-vulnerabilities-by-configuring-your-parsers-properly" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ avoid-xml-vulnerabilities-by-configuring-your-parsers-properly" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ avoid-xml-vulnerabilities-by-configuring-your-parsers-properly">â€‹</a></h3><p>XML is a dangerous markup language that contains features for accessing system resources. Some implementations of XSLT even support embedded code. For this reason, you must be extremely cautious when processing it.</p><ol>
<li>Avoid accepting XML/XSLT from untrusted sources if you can.</li>
<li>If you parameterize XML, XSLT, or XPath expressions, use a proper software component for doing so. This is to avoid injection vulnerabilities. Don&#x27;t use string concatenation/formatting/etc.</li>
<li>Use a well-known and thoroughly (security) tested software component for parsing XML/XSLT. This is crucial. <strong>Do not</strong> use a bad library or your code for handling XML. Furthermore, under any circumstances, do not attempt to create a custom implementation for handling XML signatures (such as SAML), because there are so many things that can go wrong.</li>
<li>Configure your parser properly. Disable document for XSLT. Disable xinclude. Disable document type definitions. Disable external entities. Enable DOS protection. The specific options will vary on the implementation, do some research on your chosen parser.</li>
</ol><p>Further reading</p><ul>
<li><a href="https://portswigger.net/web-security/xxe" target="_blank" rel="noopener noreferrer">XXE Attacks &amp; Prevention</a></li>
<li><a href="https://www.bugcrowd.com/blog/advice-from-a-bug-hunter-xxe/" target="_blank" rel="noopener noreferrer">Hunting XXE For Fun And Profit</a></li>
<li><a href="https://www.ws-attacks.org/Web_Service_Attacks_By_Category" target="_blank" rel="noopener noreferrer">WS Attacks</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="avoid-url-injection-vulnerabilities-by-using-proper-class-for-url-construction"><strong>Avoid URL injection vulnerabilities by using proper class for URL construction</strong><a href="#avoid-url-injection-vulnerabilities-by-using-proper-class-for-url-construction" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ avoid-url-injection-vulnerabilities-by-using-proper-class-for-url-construction" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ avoid-url-injection-vulnerabilities-by-using-proper-class-for-url-construction">â€‹</a></h3><p>URL injections happen when you have something like this:<br>
<!-- -->flavour = request.getParam(&quot;flavour&quot;);<br>
<!-- -->url = &quot;https:/api.local/pizzas/&quot; + flavour + &quot;/&quot;;<br>
<!-- -->return get(url).json();</p><p>And someone enters a value like this:<br>
<!-- -->../admin/all-the-sensitive-things/</p><p>This results in the API call returning a response for <a href="https://api.local/admin/all-the-sensitive-things/" target="_blank" rel="noopener noreferrer">https://api.local/admin/all-the-sensitive-things/</a> instead of the pizza endpoint like the developer intended.<br>
<!-- -->And the solution, as always, is to use a proper URL construction library to parameterize the URL so that the values get properly encoded.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="avoid-path-traversal-vulnerabilities-by-using-a-proper-class-to-construct-the-paths"><strong>Avoid path traversal vulnerabilities by using a proper class to construct the paths</strong><a href="#avoid-path-traversal-vulnerabilities-by-using-a-proper-class-to-construct-the-paths" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ avoid-path-traversal-vulnerabilities-by-using-a-proper-class-to-construct-the-paths" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ avoid-path-traversal-vulnerabilities-by-using-a-proper-class-to-construct-the-paths">â€‹</a></h3><p>Just like URL addresses, file paths can also end up pointing to unwanted locations if an attacker manages to sneak a ../../../ sequence somewhere in the path. To avoid this, create a class that constructs the path safely and validates that the final path is in the intended directory. Avoid using untrusted data in the file path, or better yet, avoid using the filesystem altogether and prefer, e.g., cloud storage instead.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://owasp.org/www-community/attacks/Path_Traversal" target="_blank" rel="noopener noreferrer">Path Traversal Attacks</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dont-use-the-filesystem-for-untrusted-content-eg-uploads-if-you-can-avoid-it"><strong>Don&#x27;t use the filesystem for untrusted content (e.g., uploads) if you can avoid it</strong><a href="#dont-use-the-filesystem-for-untrusted-content-eg-uploads-if-you-can-avoid-it" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ dont-use-the-filesystem-for-untrusted-content-eg-uploads-if-you-can-avoid-it" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ dont-use-the-filesystem-for-untrusted-content-eg-uploads-if-you-can-avoid-it">â€‹</a></h3><p>There is an infinite list of things that can go wrong when allowing your users to write the server&#x27;s filesystem. Use cloud storage instead, or if that doesn&#x27;t work for you, use binary blobs in a database.<br>
<!-- -->If you absolutely must access the disk, these guidelines could help you be safe:</p><ol>
<li>Be very careful not to allow any untrusted data to affect any part of the internal file path.</li>
<li>Keep the files in an isolated directory far from, e.g. the webroot.</li>
<li>Validate that the file contents match the expected format before writing to disk.</li>
<li>Set your filesystem permissions properly to prevent writing to unwanted locations.</li>
<li>Don&#x27;t extract compressed (e.g., ZIP) archives, as they can contain any files, including symlinks and paths to anywhere on the system.</li>
</ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dont-execute-dynamic-code-to-avoid-remote-code-execution-vulnerabilities"><strong>Don&#x27;t execute dynamic code to avoid remote code execution vulnerabilities</strong><a href="#dont-execute-dynamic-code-to-avoid-remote-code-execution-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ dont-execute-dynamic-code-to-avoid-remote-code-execution-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ dont-execute-dynamic-code-to-avoid-remote-code-execution-vulnerabilities">â€‹</a></h3><p>Don&#x27;t use eval or equivalent functions. Find a way to achieve your goals without them. Otherwise, there will be a risk that untrusted data reaches the function call, and someone will execute arbitrary code on your server.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-serialization-carefully-to-avoid-deserialization-vulnerabilities"><strong>Use serialization carefully to avoid deserialization vulnerabilities</strong><a href="#use-serialization-carefully-to-avoid-deserialization-vulnerabilities" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-serialization-carefully-to-avoid-deserialization-vulnerabilities" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ use-serialization-carefully-to-avoid-deserialization-vulnerabilities">â€‹</a></h3><p>Deserialization of untrusted data is a dangerous operation and can easily lead to remote code execution.</p><ol>
<li>Don&#x27;t use serialization if you can avoid it.</li>
<li>If you can serialize the objects on the server-side, then sign them digitally. And when it&#x27;s time to deserialize them again, validate the signature before proceeding with deserialization.</li>
<li>Use a well-known software component for the job and keep it rigorously up to date. Vulnerabilities are discovered in many deserialization libraries all the time. <a href="https://github.com/google/gson" target="_blank" rel="noopener noreferrer">GSon</a> is not a bad choice.</li>
<li>Use a simple text format such as JSON instead of binary formats. Also, problematic formats like XML should be avoided because then you have XML vulnerabilities to worry about in addition to deserialization ones.</li>
<li>Validate the serialized object before processing it. For example in the case of JSON, validate the JSON document against a strict JSON schema before proceeding with deserialization.</li>
</ol><p>Further reading</p><ul>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html" target="_blank" rel="noopener noreferrer">OWASP deserialization cheat sheet</a></li>
</ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="defending-threats-on-server-side---architecture"><strong>Defending Threats On Server Side - Architecture</strong><a href="#defending-threats-on-server-side---architecture" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ defending-threats-on-server-side---architecture" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ defending-threats-on-server-side---architecture">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-an-internal-api-for-accessing-data-sources-to-get-rid-of-dangerous-trust-boundaries"><strong>Create an internal API for accessing data sources to get rid of dangerous trust boundaries</strong><a href="#create-an-internal-api-for-accessing-data-sources-to-get-rid-of-dangerous-trust-boundaries" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ create-an-internal-api-for-accessing-data-sources-to-get-rid-of-dangerous-trust-boundaries" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ create-an-internal-api-for-accessing-data-sources-to-get-rid-of-dangerous-trust-boundaries">â€‹</a></h3><p>You shouldn&#x27;t put too much trust in your Internet-facing web application. For example, it shouldn&#x27;t have direct access to a database. Otherwise, when someone breaks into the Internet-facing application, your entire database will be lost.<br>
<!-- -->Instead, separate your architecture into multiple components, for example:</p><ul>
<li>Your web application on <a href="http://www.example.com" target="_blank" rel="noopener noreferrer">www.example.com</a> will authenticate your users on auth0.</li>
<li>Your web application on <a href="http://www.example.com" target="_blank" rel="noopener noreferrer">www.example.com</a> is allowed to connect to the internal API api.example.local with the authenticated user&#x27;s access-token (obtained from auth0) which will then be passed as the Authorization header when making calls to the internal API.</li>
<li>Your API on api.example.local will enforce access controls based on the (end user&#x27;s) access token and read/write the database appropriately.</li>
</ul><p>Now if an attacker fully compromises your <a href="http://www.example.com" target="_blank" rel="noopener noreferrer">www.example.com</a> application, the attacker will not have full access to the entire database, but only individual user&#x27;s data whose access tokens happen to be in the memory at the time.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="encrypt-and-authenticate-all-connections"><strong>Encrypt and authenticate all connections</strong><a href="#encrypt-and-authenticate-all-connections" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ encrypt-and-authenticate-all-connections" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ encrypt-and-authenticate-all-connections">â€‹</a></h3><p>Do not trust your internal network to be secure; there are many ways in which it could be compromised. Encrypt all system-to-system connections with TLS (that is, use HTTPS) and authenticate the connections preferably on both network and application-level:</p><ol>
<li><strong>Web App -&gt;</strong> API: <em>This is my client certificate. It&#x27;s signed by the CA that we trust, and it says &quot;CN=WebApp&quot;.</em></li>
<li>Web App <strong>&lt;- API</strong>: <em>And this is my server certificate. It&#x27;s signed by the CA that we trust, and it says &quot;CN=API&quot;</em></li>
<li><strong>Web App -&gt;</strong> API: <em>This is my access token that is signed by the IDP that we trust, I got it with OAuth2 client credentials grant flow.</em></li>
<li><strong>Web App -&gt;</strong> API: <em>...and this is the access token of the logged-in user &quot;John Doe&quot; on whose behalf I&#x27;m making this request that was also signed by the IDP that we trust.</em></li>
<li><strong>Web App -&gt;</strong> API: <em>...so could you give me John Doe&#x27;s information, please?</em></li>
<li>Web App <strong>&lt;- API</strong>: <em>Gladly. Since this is an encrypted and mutually authenticated connection network level, and because you seem to be &quot;Web App&quot; on the application level, and because you seem to be operating with the permissions of &quot;John Doe&quot;.</em></li>
</ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="manage-secrets-centrally"><strong>Manage secrets centrally</strong><a href="#manage-secrets-centrally" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ manage-secrets-centrally" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ manage-secrets-centrally">â€‹</a></h3><p>Without a proper secrets management solution, it is not easy to keep credentials short-lived, audit-logged, and not to expose them to human eyes. For this reason (and many others) it is recommended to use a tool such as the HashiCorp vault to centrally manage integration secrets, encryption keys, and the like.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://www.vaultproject.io/" target="_blank" rel="noopener noreferrer">HashiCorp Vault</a></li>
</ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="secure-development-considerations"><strong>Secure Development Considerations</strong><a href="#secure-development-considerations" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ secure-development-considerations" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ secure-development-considerations">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="threat-model"><strong>Threat model</strong><a href="#threat-model" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ threat-model" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ threat-model">â€‹</a></h3><p>Go through a process of thinking &quot;what could go wrong&quot; and then do something about it. Preferably do this from the get-go when you start designing a system, but it&#x27;s never too late to begin, and at any rate, you should re-visit this process when you introduce changes into the system.<br>
<!-- -->For example:<br>
<!-- -->Jim: What if an attacker breaches the Internet-facing web server?<br>
<!-- -->Bob: Well then we&#x27;d be royally screwed.<br>
<!-- -->Jim: Okay so we have a trust relationship there, we trust that the Internet facing web server will not be pwned. Can we really trust that?<br>
<!-- -->Bob: Well no, there are a gazillion things that could result in that thing getting hacked, for example vulnerabilities in our own code, or vulnerabilities in a dependency that we use, or perhaps vulnerabilities in our web server software.<br>
<!-- -->Jim: Right. So let&#x27;s break that trust relationship. But how?<br>
<!-- -->Bob: Let&#x27;s break the monolith and create an internal API that does the actual database access. Then the frontend web server will not have access to everything at once.<br>
<!-- -->Jim: Great idea. So what else could go wrong?<br>
<!-- -->Bob: Well what if an attacker breaches our internal network?<br>
<!-- -->Jim: All would be lost, the server-to-server connections are all unencrypted.<br>
<!-- -->Bob: ...<br>
<!-- -->This is threat modeling and it doesn&#x27;t have to be complex or scary. Use it to discover dangerous trust relationships and then break those relationships.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="force-peer-review-in-source-control"><strong>Force peer review in source control</strong><a href="#force-peer-review-in-source-control" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ force-peer-review-in-source-control" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ force-peer-review-in-source-control">â€‹</a></h3><p>Implement a technical control that prevents code from entering the repository without at least one or two other developers approving it. This is the basis of your secure development lifecycle because now two things happen:</p><ol>
<li>If an attacker compromises the workstation of a developer or the developer goes rogue, it will not be possible to directly push malicious code into the repository.</li>
<li>If a developer makes a mistake and tries to introduce vulnerable code into the repository, there is a good chance that the other developers reviewing the code will catch the error before it gets merged.</li>
</ol><p>Further reading</p><ul>
<li><a href="https://docs.gitlab.com/ee/user/project/merge_requests/merge_request_approvals.html#required-approvals" target="_blank" rel="noopener noreferrer">GitLab - Required Approvals</a></li>
<li><a href="https://confluence.atlassian.com/bitbucketserver/checks-for-merging-pull-requests-776640039.html" target="_blank" rel="noopener noreferrer">BitBucket - Checks for merging pull requests</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/devops/repos/git/branch-policies?view=azure-devops" target="_blank" rel="noopener noreferrer">Azure DevOps - Improve code quality with branch policies</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="automate-the-ci-pipeline-and-restrict-mere-mortal-access-to-it"><strong>Automate the CI pipeline and restrict mere mortal access to it</strong><a href="#automate-the-ci-pipeline-and-restrict-mere-mortal-access-to-it" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ automate-the-ci-pipeline-and-restrict-mere-mortal-access-to-it" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ automate-the-ci-pipeline-and-restrict-mere-mortal-access-to-it">â€‹</a></h3><p>Individual developers should be able to trigger e.g. a Jenkins build, but Jenkins should be configured to allow that and nothing else. Individual developers should not be able to introduce arbitrary code into the build phase. You can however keep the Jenkinsfile in source control as long as the peer review process is technically forced like recommended above.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-a-static-application-security-scanner-as-part-of-the-ci-pipeline"><strong>Run a static application security scanner as part of the CI pipeline</strong><a href="#run-a-static-application-security-scanner-as-part-of-the-ci-pipeline" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ run-a-static-application-security-scanner-as-part-of-the-ci-pipeline" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ run-a-static-application-security-scanner-as-part-of-the-ci-pipeline">â€‹</a></h3><p>Run a tool such as SpotBugs + FindSecBugs (or a similar tool applicable to your technology of choice) in your CI pipeline. This will help you spot some known vulnerabilities in your code before deploying it.<br>
<!-- -->You can additionally run these tools on the developer&#x27;s workstation (as an IDE plugin for example) to catch issues even before checking them to version control.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://spotbugs.github.io/" target="_blank" rel="noopener noreferrer">SpotBugs</a></li>
<li><a href="https://find-sec-bugs.github.io/" target="_blank" rel="noopener noreferrer">Find-Sec-Bugs</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="verify-dependencies-on-build-and-keep-them-at-a-minimum"><strong>Verify dependencies on build and keep them at a minimum</strong><a href="#verify-dependencies-on-build-and-keep-them-at-a-minimum" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ verify-dependencies-on-build-and-keep-them-at-a-minimum" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ verify-dependencies-on-build-and-keep-them-at-a-minimum">â€‹</a></h3><p>Every software package that you depend on is a risk. You are pulling code from someone else&#x27;s repository and executing it on your application server. So be mindful about what and how you depend on it.</p><ol>
<li>Keep the dependencies at a minimum.</li>
<li>Only use dependencies that you trust. They should all be widely used and reputable.</li>
<li>Use a build framework that supports dependency verification, and make sure the verification is enabled.</li>
</ol><p>As additional hardening restricts egress connections from your application server (described earlier in this article) to prevent any backdoors from &quot;calling home&quot;.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://docs.gradle.org/current/userguide/dependency_verification.html" target="_blank" rel="noopener noreferrer">Gradle Dependency Verification</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-a-dependency-security-scanner-as-part-of-the-ci-pipeline"><strong>Run a dependency security scanner as part of the CI pipeline</strong><a href="#run-a-dependency-security-scanner-as-part-of-the-ci-pipeline" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ run-a-dependency-security-scanner-as-part-of-the-ci-pipeline" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ run-a-dependency-security-scanner-as-part-of-the-ci-pipeline">â€‹</a></h3><p>Run a tool such as OWASP DependencyCheck as part of your CI pipeline to catch some dependencies you might be using that have known security issues in them.<br>
<!-- -->You run these tools on the developer&#x27;s workstation as well (but also run them in the CI pipeline that&#x27;s the most important thing).<br>
<!-- -->Further reading</p><ul>
<li><a href="https://owasp.org/www-project-dependency-check/" target="_blank" rel="noopener noreferrer">OWASP DependencyCheck</a></li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-a-container-image-security-scanner-as-part-of-the-ci-pipeline"><strong>Run a container image security scanner as part of the CI pipeline</strong><a href="#run-a-container-image-security-scanner-as-part-of-the-ci-pipeline" class="hash-link" aria-label="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ run-a-container-image-security-scanner-as-part-of-the-ci-pipeline" title="Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ run-a-container-image-security-scanner-as-part-of-the-ci-pipeline">â€‹</a></h3><p>If you use containers, use a tool such as Trivy to scan the created container image for known vulnerabilities.<br>
<!-- -->Further reading</p><ul>
<li><a href="https://github.com/aquasecurity/trivy" target="_blank" rel="noopener noreferrer">Trivy</a></li>
</ul></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/divar-ir/kenar-docs/tree/main/docs/docs/standards/security.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø·Ø§Ù„Ø¨ Ø§ÛŒÙ† ØµÙØ­Ù‡</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ØµÙØ­Ø§Øª Ù…Ø³ØªÙ†Ø¯Ø§Øª"><a class="pagination-nav__link pagination-nav__link--prev" href="/kenar-docs/standards/policies"><div class="pagination-nav__sublabel">Ù‚Ø¨Ù„ÛŒ</div><div class="pagination-nav__label">Ù‚ÙˆØ§Ø¹Ø¯ ÙØ¹Ø§Ù„ÛŒØª Ø¯Ø± Â«Ú©Ù†Ø§Ø± Ø¯ÛŒÙˆØ§Ø±Â»</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kenar-docs/widgets/"><div class="pagination-nav__sublabel">Ø¨Ø¹Ø¯ÛŒ</div><div class="pagination-nav__label">Ø³Ø§Ø®ØªØ§Ø± ÙˆÛŒØ¬Øª Ù‡Ø§ÛŒ Ø¯ÛŒÙˆØ§Ø± (Widgets)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#data-encryption--protection" class="table-of-contents__link toc-highlight"><strong>Data Encryption &amp; Protection</strong></a><ul><li><a href="#encrypt-all-data-in-transit" class="table-of-contents__link toc-highlight"><strong>Encrypt all data in transit:</strong></a></li><li><a href="#encrypt-all-data-at-rest" class="table-of-contents__link toc-highlight"><strong>Encrypt all data at rest:</strong></a></li><li><a href="#tokenize-sensitive-fields" class="table-of-contents__link toc-highlight"><strong>Tokenize sensitive fields:</strong></a></li><li><a href="#do-not-store-pii-without-legal-enforcement" class="table-of-contents__link toc-highlight"><strong>Do not store PII without legal enforcement:</strong></a></li></ul></li><li><a href="#access-control--authentication" class="table-of-contents__link toc-highlight"><strong>Access Control &amp; Authentication</strong></a><ul><li><a href="#enforce-multi-factor-authentication-mfa" class="table-of-contents__link toc-highlight"><strong>Enforce Multi-Factor Authentication (MFA):</strong></a></li><li><a href="#assign-role-based-access-permissions" class="table-of-contents__link toc-highlight"><strong>Assign role-based access permissions:</strong></a></li><li><a href="#automatically-terminate-inactive-sessions" class="table-of-contents__link toc-highlight"><strong>Automatically terminate inactive sessions:</strong></a></li></ul></li><li><a href="#data-handling--storage" class="table-of-contents__link toc-highlight"><strong>Data Handling &amp; Storage</strong></a><ul><li><a href="#delete-data-after-retention-periods" class="table-of-contents__link toc-highlight"><strong>Delete data after retention periods:</strong></a></li><li><a href="#store-data-only-in-approved-environments" class="table-of-contents__link toc-highlight"><strong>Store data only in approved environments:</strong></a></li><li><a href="#mask-sensitive-data-in-logsuis" class="table-of-contents__link toc-highlight"><strong>Mask sensitive data in logs/UIs:</strong></a></li></ul></li><li><a href="#network-security" class="table-of-contents__link toc-highlight"><strong>Network Security</strong></a><ul><li><a href="#isolate-systems-with-firewallssegmentation" class="table-of-contents__link toc-highlight"><strong>Isolate systems with firewalls/segmentation:</strong></a></li><li><a href="#secure-apis-with-authentication-and-rate-limits" class="table-of-contents__link toc-highlight"><strong>Secure APIs with authentication and rate limits:</strong></a></li><li><a href="#use-a-waf" class="table-of-contents__link toc-highlight"><strong>Use a WAF</strong></a></li><li><a href="#configure-your-web-server-carefully-to-avoid-http-desync-attacks" class="table-of-contents__link toc-highlight"><strong>Configure your web server carefully to avoid HTTP desync attacks</strong></a></li><li><a href="#use-containers" class="table-of-contents__link toc-highlight"><strong>Use containers</strong></a></li></ul></li><li><a href="#contractual-obligations" class="table-of-contents__link toc-highlight"><strong>Contractual Obligations</strong></a><ul><li><a href="#adhere-to-data-processing-agreements-dpas" class="table-of-contents__link toc-highlight"><strong>Adhere to Data Processing Agreements (DPAs):</strong></a></li><li><a href="#report-breaches-within-24-hours" class="table-of-contents__link toc-highlight"><strong>Report breaches within 24 hours:</strong></a></li><li><a href="#submit-to-annual-penetration-tests" class="table-of-contents__link toc-highlight"><strong>Submit to annual penetration tests:</strong></a></li></ul></li><li><a href="#continuous-security-practices" class="table-of-contents__link toc-highlight"><strong>Continuous Security Practices</strong></a><ul><li><a href="#conduct-continuous-vulnerability-scanning" class="table-of-contents__link toc-highlight"><strong>Conduct continuous vulnerability scanning:</strong></a></li><li><a href="#monitor-systems-in-real-time" class="table-of-contents__link toc-highlight"><strong>Monitor systems in real time:</strong></a></li><li><a href="#update-security-practices-annually" class="table-of-contents__link toc-highlight"><strong>Update security practices annually:</strong></a></li></ul></li><li><a href="#defending-web-application-threats" class="table-of-contents__link toc-highlight"><strong>Defending Web Application Threats</strong></a><ul><li><a href="#use-https-and-only-https-to-protect-your-users-from-network-attacks" class="table-of-contents__link toc-highlight"><strong>Use HTTPS and only HTTPS to protect your users from network attacks</strong></a></li><li><a href="#use-hsts-and-preloading-to-protect-your-users-from-ssl-stripping-attacks" class="table-of-contents__link toc-highlight"><strong>Use HSTS and preloading to protect your users from SSL stripping attacks</strong></a></li><li><a href="#serve-cookies-with-the-secure-attribute-to-protect-your-user-from-network-attacks" class="table-of-contents__link toc-highlight"><strong>Serve cookies with the &#39;Secure&#39; attribute to protect your user from network attacks</strong></a></li><li><a href="#generate-html-safely-to-avoid-xss-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Generate HTML safely to avoid XSS vulnerabilities</strong></a></li><li><a href="#use-javascript-safely-to-avoid-xss-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Use JavaScript safely to avoid XSS vulnerabilities</strong></a></li><li><a href="#sanitize-and-sandbox-untrusted-content-to-avoid-xss-and-other-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Sanitize and sandbox untrusted content to avoid XSS and other vulnerabilities</strong></a></li><li><a href="#implement-an-effective-content-security-policy-to-protect-your-users-from-xss-xsleak-and-other-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Implement an effective Content Security Policy to protect your users from XSS, xsleak and other vulnerabilities</strong></a></li><li><a href="#serve-cookies-with-the-httponly-attribute-to-protect-them-from-xss-attacks" class="table-of-contents__link toc-highlight"><strong>Serve cookies with the HttpOnly attribute to protect them from XSS attacks</strong></a></li><li><a href="#serve-downloads-with-a-proper-content-disposition-header-to-avoid-xss-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Serve downloads with a proper Content-Disposition header to avoid XSS vulnerabilities</strong></a></li><li><a href="#serve-api-responses-with-a-proper-content-disposition-header-to-avoid-reflected-download-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Serve API responses with a proper Content-Disposition header to avoid reflected download vulnerabilities</strong></a></li><li><a href="#use-your-platforms-anti-csrf-mechanism-to-avoid-csrf-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Use your platform&#39;s anti-CSRF mechanism to avoid CSRF vulnerabilities</strong></a></li><li><a href="#validate-the-oauthoidc-state-parameter-to-avoid-csrf-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Validate the OAuth/OIDC state parameter to avoid CSRF vulnerabilities</strong></a></li><li><a href="#use-http-verbs-properly-to-avoid-csrf-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Use HTTP verbs properly to avoid CSRF vulnerabilities</strong></a></li><li><a href="#serve-cookies-with-the-samesite-attribute-to-protect-your-users-from-csrf-vulnerabilities-xsleaks-and-sometimes-xss-as-well" class="table-of-contents__link toc-highlight"><strong>Serve cookies with the SameSite attribute to protect your users from CSRF vulnerabilities, xsleaks and sometimes XSS as well</strong></a></li><li><a href="#create-a-fresh-session-id-on-login-to-protect-against-session-fixation-attacks" class="table-of-contents__link toc-highlight"><strong>Create a fresh session ID on login to protect against session fixation attacks</strong></a></li><li><a href="#name-your-cookies-right-to-protect-against-session-fixation-attacks" class="table-of-contents__link toc-highlight"><strong>Name your cookies right to protect against session fixation attacks</strong></a></li><li><a href="#serve-proper-cache-control-headers-to-protect-your-users-data-from-subsequent-computer-users" class="table-of-contents__link toc-highlight"><strong>Serve proper Cache-Control headers to protect your user&#39;s data from subsequent computer users</strong></a></li><li><a href="#serve-a-clear-site-data-header-upon-log-out-to-protect-your-users-data-from-subsequent-computer-users" class="table-of-contents__link toc-highlight"><strong>Serve a Clear-Site-Data header upon log out to protect your user&#39;s data from subsequent computer users</strong></a></li><li><a href="#log-your-users-out-properly-to-protect-their-data-from-subsequent-computer-users" class="table-of-contents__link toc-highlight"><strong>Log your users out properly to protect their data from subsequent computer users</strong></a></li><li><a href="#use-sessionstorage-for-javascript-secrets-to-protect-your-users-data-from-subsequent-computer-users" class="table-of-contents__link toc-highlight"><strong>Use SessionStorage for JavaScript secrets to protect your user&#39;s data from subsequent computer users</strong></a></li><li><a href="#dont-transmit-sensitive-data-in-the-url-because-urls-are-not-designed-to-be-secret" class="table-of-contents__link toc-highlight"><strong>Don&#39;t transmit sensitive data in the URL because URLs are not designed to be secret</strong></a></li><li><a href="#use-a-referrer-policy-to-prevent-url-addresses-from-leaking-to-other-websites" class="table-of-contents__link toc-highlight"><strong>Use a referrer policy to prevent URL addresses from leaking to other websites</strong></a></li><li><a href="#use-a-unique-domain-name-for-your-application-to-protect-it-from-other-applications-under-the-same-origin-and-vice-versa" class="table-of-contents__link toc-highlight"><strong>Use a unique domain name for your application to protect it from other applications under the same origin (and vice versa)</strong></a></li><li><a href="#dont-use-cors-unless-you-have-to-and-if-you-have-to-be-careful-with-it" class="table-of-contents__link toc-highlight"><strong>Don&#39;t use CORS unless you have to, and if you have to, be careful with it</strong></a></li><li><a href="#use-websockets-properly-to-avoid-csrf-and-other-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Use WebSockets properly to avoid CSRF and other vulnerabilities</strong></a></li><li><a href="#implement-protections-against-cross-site-leaks" class="table-of-contents__link toc-highlight"><strong>Implement protections against cross-site leaks</strong></a></li><li><a href="#validate-input-properly-to-protect-your-application-from-so-so-many-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Validate input properly to protect your application from so, so many vulnerabilities</strong></a></li><li><a href="#catch-exceptions-gracefully-to-avoid-leaking-technical-details" class="table-of-contents__link toc-highlight"><strong>Catch exceptions gracefully to avoid leaking technical details</strong></a></li><li><a href="#dont-do-authentication-yourself" class="table-of-contents__link toc-highlight"><strong>Don&#39;t do authentication yourself</strong></a></li><li><a href="#use-strict-access-controls-to-prevent-unauthorized-access-to-data-or-functionality" class="table-of-contents__link toc-highlight"><strong>Use strict access controls to prevent unauthorized access to data or functionality</strong></a></li><li><a href="#use-proper-tools-and-techniques-to-avoid-injection-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Use proper tools and techniques to avoid injection vulnerabilities</strong></a></li><li><a href="#construct-database-queries-safely-to-avoid-sql-injection-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Construct database queries safely to avoid SQL injection vulnerabilities</strong></a></li><li><a href="#do-not-run-os-commands" class="table-of-contents__link toc-highlight"><strong>Do not run OS commands</strong></a></li><li><a href="#avoid-xml-vulnerabilities-by-configuring-your-parsers-properly" class="table-of-contents__link toc-highlight"><strong>Avoid XML vulnerabilities by configuring your parsers properly</strong></a></li><li><a href="#avoid-url-injection-vulnerabilities-by-using-proper-class-for-url-construction" class="table-of-contents__link toc-highlight"><strong>Avoid URL injection vulnerabilities by using proper class for URL construction</strong></a></li><li><a href="#avoid-path-traversal-vulnerabilities-by-using-a-proper-class-to-construct-the-paths" class="table-of-contents__link toc-highlight"><strong>Avoid path traversal vulnerabilities by using a proper class to construct the paths</strong></a></li><li><a href="#dont-use-the-filesystem-for-untrusted-content-eg-uploads-if-you-can-avoid-it" class="table-of-contents__link toc-highlight"><strong>Don&#39;t use the filesystem for untrusted content (e.g., uploads) if you can avoid it</strong></a></li><li><a href="#dont-execute-dynamic-code-to-avoid-remote-code-execution-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Don&#39;t execute dynamic code to avoid remote code execution vulnerabilities</strong></a></li><li><a href="#use-serialization-carefully-to-avoid-deserialization-vulnerabilities" class="table-of-contents__link toc-highlight"><strong>Use serialization carefully to avoid deserialization vulnerabilities</strong></a></li></ul></li><li><a href="#defending-threats-on-server-side---architecture" class="table-of-contents__link toc-highlight"><strong>Defending Threats On Server Side - Architecture</strong></a><ul><li><a href="#create-an-internal-api-for-accessing-data-sources-to-get-rid-of-dangerous-trust-boundaries" class="table-of-contents__link toc-highlight"><strong>Create an internal API for accessing data sources to get rid of dangerous trust boundaries</strong></a></li><li><a href="#encrypt-and-authenticate-all-connections" class="table-of-contents__link toc-highlight"><strong>Encrypt and authenticate all connections</strong></a></li><li><a href="#manage-secrets-centrally" class="table-of-contents__link toc-highlight"><strong>Manage secrets centrally</strong></a></li></ul></li><li><a href="#secure-development-considerations" class="table-of-contents__link toc-highlight"><strong>Secure Development Considerations</strong></a><ul><li><a href="#threat-model" class="table-of-contents__link toc-highlight"><strong>Threat model</strong></a></li><li><a href="#force-peer-review-in-source-control" class="table-of-contents__link toc-highlight"><strong>Force peer review in source control</strong></a></li><li><a href="#automate-the-ci-pipeline-and-restrict-mere-mortal-access-to-it" class="table-of-contents__link toc-highlight"><strong>Automate the CI pipeline and restrict mere mortal access to it</strong></a></li><li><a href="#run-a-static-application-security-scanner-as-part-of-the-ci-pipeline" class="table-of-contents__link toc-highlight"><strong>Run a static application security scanner as part of the CI pipeline</strong></a></li><li><a href="#verify-dependencies-on-build-and-keep-them-at-a-minimum" class="table-of-contents__link toc-highlight"><strong>Verify dependencies on build and keep them at a minimum</strong></a></li><li><a href="#run-a-dependency-security-scanner-as-part-of-the-ci-pipeline" class="table-of-contents__link toc-highlight"><strong>Run a dependency security scanner as part of the CI pipeline</strong></a></li><li><a href="#run-a-container-image-security-scanner-as-part-of-the-ci-pipeline" class="table-of-contents__link toc-highlight"><strong>Run a container image security scanner as part of the CI pipeline</strong></a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">2025 Â© <a href="https://divar.ir/kenar" target="_blank">Ú©Ù†Ø§Ø± Ø¯ÛŒÙˆØ§Ø±</a></div></div></div></footer></div>
</body>
</html>