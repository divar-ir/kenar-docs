<br><br>

# ุงุญุฑุงุฒ ุจุงุฒ

ุจุฑุฎ ูุงุจูุชโูุง **ฺฉูุงุฑ ุฏูุงุฑ**โ ูุงุฒููุฏ ุงุฌุงุฒูโ ฺฉุงุฑุจุฑูุง ูุณุชูุฏ: ูุซูุง [ุงูุฒูุฏู ูุญุชูุง ุจู ุขฺฏู][ุฑุงูููุง ยป ุณุงุฎุช ุงูุฒููู] ุง [ุฏุฑุงูุช ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ][ุฑุงูููุง ยป ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ] ูุงุฒููุฏ ฺฉุณุจ ุงุฌุงุฒู ุงุฒ ฺฉุงุฑุจุฑ ุงุณุช. ุฏุฑ **ฺฉูุงุฑ ุฏูุงุฑ**ุ ูุฑุขูุฏ ฺฉุณุจ ุงุฌุงุฒู ุงุฒ ฺฉุงุฑุจุฑ ุทุจู ุงุณุชุงูุฏุงุฑุฏ [OAuth 2.0][oauth] ุงูุฌุงู ูโุดูุฏ:


ฑ. ๐๏ธ ุงูพูฺฉุดู ฺฉุงุฑุจุฑ ุฑุง ุจุฑุง ฺฉุณุจ ุงุฌุงุฒู [ุจู ุฏูุงุฑ ูุฏุงุช (redirect) ูโฺฉูุฏ][step 1]. \
ฒ. โช๏ธ ฺฉุงุฑุจุฑุ ุจุนุฏ ุงุฒ ุตุฏูุฑ ุง ุฑุฏ ุงุฌุงุฒูโูุง ุฏุฑุฎูุงุณุชุ [ุจู ุขุฏุฑุณ ูุดุฎุตโุดุฏู ุชูุณุท ุงูพูฺฉุดู (redirect URI) ูุฏุงุช ูโุดูุฏ][step 2]. \
ณ. ๐๏ธ ุฏุฑุตูุฑุช ุตุฏูุฑ ุงุฌุงุฒูุ ุงูพูฺฉุดู ูโุชูุงูุฏ ุงุฒ ุฏูุงุฑ [ุชูฺฉู (access token) ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ูุงุจูุชโูุง ูุฏูุธุฑ ุฏุฑุงูุช โฺฉูุฏ][step 3]. \
ด. ๐ฎ ุงูพูฺฉุดู ุจุง ุงุณุชูุงุฏู ุงุฒ ุชูฺฉู ุฏุฑุงูุชุ [ุงุฒ ูุงุจูุชโูุง ูุฏูุธุฑ ุงุณุชูุงุฏู ูโฺฉูุฏ][step 4]. \
ต. โป๏ธ ุฏุฑ ุตูุฑุช ูุงุฒุ ุงูพูฺฉุดู ุจุง ุงุณุชูุงุฏู ุงุฒ ุฑูุฑุด ุชูฺฉู ุฏุฑุงูุชุ [ูโุชูุงูุฏ ุชูฺฉู ุฌุฏุฏ ุฏุฑุงูุช ฺฉูุฏ][step 5].


<br><br>

```mermaid
sequenceDiagram
  app->>+divar: 1. Redirect
  divar->>-app: 2. Redirect to <redirect_uri> with <code>
  app-->>+divar: 3. Request access token with <code>
  divar-->>-app: <access_token>
  app-)divar: 4. Request API with <access_token>
```

<br><br>

---

๐ ุงุจุฒุงุฑูุง ูุชููุน ุจุฑุง ฺฉุงุฑ ุจุง ุงุณุชุงูุฏุงุฑุฏ OAuth 2.0 ุฏุฑ ุฒุจุงูโูุง ู ูุฑูโูุฑฺฉโูุง ูุฎุชูู ูุฌูุฏ ุฏุงุฑุฏ. ุจุฑุฎ ุงุฒ ุงู ุงุจุฒุงุฑูุง ุฑุง ูโุชูุงูุฏ [ุงูุฌุง ุจุจูุฏ][oauth > tools]. 

---

<br>

## ๐๏ธ ฺฏุงู ุงูู: ุฏุฑุฎูุงุณุช ุงุฌุงุฒู

ุจุฑุง ุฏุฑุฎูุงุณุช ุงุฌุงุฒูุ ฺฉุงุฑุจุฑ ุฑุง ุจู ุขุฏุฑุณ ุจู ุดฺฉู ุฒุฑ ูุฏุงุช (redirect) ฺฉูุฏ:

```url
https://api.divar.ir/oauth2/auth?response_type=code
  &client_id=<app-slug>
  &redirect_uri=<redirect-uri>
  &scope=<scopes>
  &state=<state>
```


- *ูพุงุฑุงูุชุฑ `client_id`*: ุฏุฑ ุงู ูพุงุฑุงูุชุฑ [ุดูุงุณูโ ุงูพูฺฉุดู (Slug ุฏุฑ ูพูู ฺฉูุงุฑ)][ุฑุงูููุง ยป ุงุณูุงฺฏ] ุฑุง ูุฑุงุฑ ุฏูุฏ.
- *ูพุงุฑุงูุชุฑ `redirect_uri`*: ุขุฏุฑุณ ุงุฒ ุงูพูฺฉุดู ฺฉู ฺฉุงุฑุจุฑ ุจุนุฏ ุงุฒ ุตุฏูุฑ (ุง ุฑุฏ) ุงุฌุงุฒูโูุง ุฏุฑุฎูุงุณุช ุจู ุขู ูุฏุงุช ุดูุฏ.
  - ูฺ ูพุงุฑุงูุชุฑ ุฏุฑ ุงู ุขุฏุฑุณ ูุฑุงุฑ ูุฏูุฏ!
  - ููุฏุงุฑ `redirect_uri` ุญุชูุง ุจุงุฏ [URL encode][urlencode] ุดุฏู ุจุงุดุฏ.
  - ุงู ุขุฏุฑุณ ุจุงุฏ ุจุง ฺฉ ุงุฒ ุขุฏุฑุณ ูุง ฺฉู ุฏุฑ [ูพูู ฺฉูุงุฑ][ูพูู ฺฉูุงุฑ] ุจู ููุธูุฑ ุขุฏุฑุณโูุง ูุฌุงุฒ ุจุฑุง ูุฏุงุช ุงุฒ OAuth ุชูุธู ฺฉุฑุฏูโุงุฏ ูุทุงุจูุช ุฏุงุดุชู ุจุงุดุฏ.
- *ูพุงุฑุงูุชุฑ `scope`*: ุงุฌุงุฒูโูุง ููุฑุฏ ูุงุฒ ุฑุง ุฏุฑ ุงู ูพุงุฑุงูุชุฑ ูุณุช  ู ุจุง ุงุณูพุณ `" "` ุงุฒ ูู ุฌุฏุง ฺฉูุฏ. [ุฏุฑ ููุฑุฏ ุงุฌุงุฒูโูุง ุงูุฌุง ุฑุง ุจุฎูุงูุฏ][ุงุฌุงุฒูโูุง].
- *ูพุงุฑุงูุชุฑ `state`*: ฺฉ ููุฏุงุฑ ุฏูุฎูุงู ฺฉู ุฏุฑ ุจุงุฒฺฏุดุช ฺฉุงุฑุจุฑ ุจู ุงูพูฺฉุดู ุดูุง ูุฌุฏุฏ ุฏุฑ ูพุงุฑุงูุชุฑูุง URL ูุฑุงุฑ ูโฺฏุฑุฏ.
  - ุจุง ุงุณุชูุงุฏู ุงุฒ ูพุงุฑุงูุชุฑ `state` ูโุชูุงูุฏ ููุดุงุก ุฏุฑุฎูุงุณุช ุจุงุฒฺฏุดุชู ุฑุง ุงุญุฑุงุฒ ููุงุฏ.
  - ุงฺฏุฑ ุจุฑุง `redirect_uri` ูุงุฒ ุจู ุชูุธู ูพุงุฑุงูุชุฑ ุฏุงุฑุฏุ ููุงุฏุฑ ุงู ูพุงุฑุงูุชุฑูุง ุฑุง ูโุชูุงูุฏ ุฏุฑ `state` ุฐุฎุฑู ฺฉูุฏ.
  - ุฏูุช ฺฉูุฏ ฺฉู ุญุชูุง `state` ุดุงูู ููุงุฏุฑ ฺฉุชุง ู ุชุตุงุฏู ุจุงุดุฏ ุชุง ุจุชูุงูุฏ [ุฏุฑุฎูุงุณุชโูุง ุจุงุฒฺฏุดุช ุฏุฑูุบู][oauth > state] ุฑุง ุชุดุฎุต ุฏูุฏ.

<br>

### ๐ ุงุฌุงุฒูโูุง (Scope)

ูุงุจูุชโูุง ูุฎุชููุ ูุงุฒููุฏ ฺฉุณุจ ุงุฌุงุฒู (ุง scope)ูุง ูุชูุงูุช ุงุฒ ฺฉุงุฑุจุฑ ูุณุชูุฏ. ุจุฑุฎ ุงุฒ ุงู ุงุฌุงุฒูโูุง ูุฑุจูุท ุจู *ุดุก ุฎุงุต* ูุณุชูุฏ: ูุซูุง ุจุฑุง ุงูุฒูุฏู ูุญุชูุง ุจู ฺฉ ุขฺฏู ุฎุงุตุ ูโุจุงุณุช ุงุฌุงุฒูโ ุณุงุฎุช ุงูุฒููู ุจุฑ ุฑู ููุงู ุขฺฏู ุฑุง ุงุฒ ฺฉุงุฑุจุฑ ุฏุฑุงูุช ฺฉูุฏ. ุงู ููุน ุงุฌุงุฒูโูุง ุงุฒ ุดฺฉู ฺฉู `SCOPE.IDENTIFIER` ุชุจุนุช ูโฺฉููุฏ ฺฉู ุฏุฑ ุขู:
- ูุณูุช `SCOPE` ููุงุงูฺฏุฑ ฺฉู ุงุฌุงุฒูโ ูุฑุจูุทู (ูุซูุง [ุงุถุงูู ฺฉุฑุฏู ุงูุฒููู ุจู ุขฺฏู][ุฑุงูููุง ยป ุณุงุฎุช ุงูุฒููู]) ุงุณุช.
- ูุณูุช `IDENTIFIER` ููุงุงูฺฏุฑ *ุดุก ุฎุงุตุณุช* ฺฉู ุงุฌุงุฒู ูุฑุจูุท ุจู ุขูุณุช (ูุซูุง ุดูุงุณูโ ุขฺฏู).

<br>

> ๐ก ***ูุซุงู*** \
> ุจุฑุง ุฏุฑุงูุช ุงุฌุงุฒูโ ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ุงูุฒููู ุจู ุขฺฏู ุจุง ุดูุงุณูโ `AZTH74V2`ุ ูพุงุฑุงูุชุฑ scope ุฑุง ุจู ุดฺฉู ุฒุฑ ููุฏุงุฑ ุฏูุฏ. ุดูุงุณูโ ุขฺฏู ุฑุง ูโุชูุงูุฏ ุงุฒ ูพุงุฑุงูุชุฑ `post_token` ฺฉู ููฺฏุงู [ูุฑุงุฎูุงู ุงูพูฺฉุดู][ุฑุงูููุง ยป ูุฏุฑุช ุงูพ] ุงุฑุงุฆู ุดุฏู ุงุณุช ุจุฎูุงูุฏ.
>
> ```url
> &scope=POST_ADDON_CREATE.AZTH74V2
> ```

<br>

ุจุฑุฎ ุงุฌุงุฒูโูุง ุฏฺฏุฑ ูุฑุจูุท ุจู *ุดุก ุฎุงุต* ูุณุชูุฏ ู ุนููู ูุณุชูุฏ: ุจุฑุง ูุซุงู ุฏุฑุงูุช ุดูุงุฑูโ ุชููู ฺฉุงุฑุจุฑ (ุจุฑุง ฺฉ ฺฉุงุฑุจุฑ ุฎุงุต) ฺฉ ุงุฌุงุฒู (scope) ุนูููุณุช. ุงู ููุน ุงุฌุงุฒูโูุง ุจุง ุดฺฉู `SCOPE` ููุงุงูุฏู ูโุดููุฏ.

<br>

>๐ก ***ูุซุงู*** \
> ุจุฑุง ุฏุฑุงูุช ุงุฌุงุฒูโ ุฏุณุชุฑุณ ุจู ุดูุงุฑูโ ุชููู ฺฉุงุฑุจุฑุ ูพุงุฑุงูุชุฑ scope ุฑุง ุจู ุดฺฉู ุฒุฑ ุชูุธู ฺฉูุฏ:
> ```url
> &scope=USER_PHONE
> ```

<br>

>๐ก ***ูุซุงู*** \
> ุจุฑุง ุฏุฑุงูุช ุงุฌุงุฒูโ ุฏุณุชุฑุณ ุจุฑุง ุงุฑุณุงู ูพุงู ุจู ฺฉุงุฑุจุฑุ ูโุจุงุณุช ุงุทูุงุนุงุช ุฏุฑุงูุช ุดุงูู user_id, post_token, peer_id ุฑุง ุจุง ุงุณููุงุฏู ุงุฒ ยซ:ยป ุฑุง ุจู ูู ุจู ฺุณุจุงูุฏ ยซuser_id:post_token:peer_idยป ุณูพุณ ุจุง ุงุณุชูุงุฏู ุงุฒ base64 ฺฉุฏ ฺฉุฑุฏู ู ุงุฒ ุทุฑู ูพุงุฑุงูุชุฑ scope ุจู ุดฺฉู ุฒุฑ ุงุฑุณุงู ููุงุฏ:
> 
> ```url
> &scope=CHAT_MESSAGE_SEND.BASE64_CODING_REQUEST_DATA
> ```

<br>

ูพุงุฑุงูุชุฑ scope ูโุชูุงูุฏ ุดุงูู ฺูุฏ ุงุฌุงุฒูโ ุจุงุดุฏุ ฺฉู ุฏุฑ ุงู ุตูุฑุช ุจุงุฏ ุงุฒ ูุฑู ฺฉู `SCOPE_1 SCOPE_2 SCOPE_3 ...` ุชุจุนุช ฺฉูุฏ.

<br>

>๐ก***ูุซุงู*** \
> ุจุฑุง ุฏุฑุงูุช ููุฒูุงู ุงุฌุงุฒูโ ุฏุณุชุฑุณ ุจู ุดูุงุฑูโ ฺฉุงุฑุจุฑ ู ุงุฌุงุฒูโ ุงุถุงูู ฺฉุฑุฏู ุงูุฒููู ุจู ุขฺฏู ุจุง ุดูุงุณูโ `AZTH74V2`ุ ูพุงุฑุงูุชุฑ scope ุฑุง ุจู ุดฺฉู ุฒุฑ ููุฏุงุฑ ุฏูุฏ:
> ```url
> &scope=USER_PHONE POST_ADDON_CREATE.AZTH74V2
> ```

<br>

ุงุฌุงุฒูโูุง ููุฑุฏ ูุงุฒ ูุฑ ูุงุจูุช ุฑุง ุฏุฑ ุตูุญูโ ูุฑุจูุท ุจู ุขู ูุงุจูุช ูโุชูุงูุฏ ุจุจูุฏ. ุฌุฏูู ุฒุฑ ูุณุช ุงุฒ ุงุฌุงุฒูโูุง ูพุฑฺฉุงุฑุจุฑุฏ ุฑุง ูุดุงู ูโุฏูุฏ.

<div align="right">

| ูุงุจูุช | ุงุฌุงุฒู | ูุซุงู |
| - | - | - |
| [ุณุงุฎุช ุงูุฒููู][ุฑุงูููุง ยป ุณุงุฎุช ุงูุฒููู] | POST_ADDON_CREATE | `POST_ADDON_CREATE.AZTH74V2` |
| [ุงุฑุณุงู ูพุงู ุฏุฑ ฺุช][ุฑุงูููุง ยป ุงุฑุณุงู ูพุงู] | CHAT_MESSAGE_SEND | `CHAT_MESSAGE_SEND.ZTliYThhODEtOTU4M` |
| [ุฏุฑุงูุช ุดูุงุฑูโ ุชููู ฺฉุงุฑุจุฑ][ุฑุงูููุง ยป ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ] | USER_PHONE | `USER_PHONE` |

</div>

<br>

---

๐ ุงุฌุงุฒูโูุง ูุณุชูู ุงุฒ ุฏุณุชุฑุณโูุง [ฺฉูุฏูุง API][ุฑุงูููุง ยป ฺฉูุฏ] ุดูุง ูุณุชูุฏ. ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ูุฑ ูุงุจูุช ูโุจุงุฏ ูู ฺฉูุฏ ุจุง ุฏุณุชุฑุณโูุง ูุงุฒู ุงุณุชูุงุฏู ฺฉูุฏุ ูู ุงุฌุงุฒูโูุง ููุฑุฏ ูุงุฒ ุฑุง ุงุฒ ฺฉุงุฑุจุฑ ุฏุฑุงูุช ููุงุฏ. ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ ุฏุฑ ููุฑุฏ ุฏุณุชุฑุณโูุงุ [ุงูุฌุง ุฑุง ุจุฎูุงูุฏ][ุฑุงูููุง ยป ุฏุณุชุฑุณ]. 

---

<br>

## โช๏ธ ฺฏุงู ุฏูู: ุจุงุฒฺฏุดุช ุจู ุงูพูฺฉุดู

ุจุนุฏ ุงุฒ ุงุชูุงู ูุฑุขูุฏ ฺฉุณุจ ุงุฌุงุฒูุ ฺู ุฏุฑ ุตูุฑุช ุชุงุฏ ู ฺู ุฏุฑ ุตูุฑุช ุฑุฏ ุงุฌุงุฒูโูุง ุฏุฑุฎูุงุณุช ุชูุณุท ฺฉุงุฑุจุฑุ ู ุจู ุขุฏุฑุณ ูุดุฎุตโุดุฏู ุฏุฑ ูพุงุฑุงูุชุฑ `redirect_uri` ุฏุฑ [ฺฏุงู ูุจู][step 1] ูุฏุงุช (redirect) ูโุดูุฏ. ุจุฑุง ูุซุงูุ ุงฺฏุฑ ููุฏุงุฑ `redirect_uri` ุฏุฑ [ฺฏุงู ูุจู][step 1] ุจู ุดฺฉู ุฒุฑ ุฏุงุฏู ุดุฏู ุจุงุดุฏ:

```url
https://api.divar.ir/oauth2/auth?response_type=code
  &cliend_id=...
  &scope=...
  &state=my-random-string
  &redirect_uri=oauth-redirect.my-app.ir
```

ุจุนุฏ ุงุฒ ุงุชูุงู ูุฑุขูุฏุ ฺฉุงุฑุจุฑ ุจู ุขุฏุฑุณ ุจู ุดฺฉู ุฒุฑ ูุฏุงุช ูโุดูุฏ:

```url
https://oauth-redirect.my-app.ir
  ?state=my-random-string
  &code=c87sDtaqmWwgis7dYyukMqy6KAArNUFkukAPW8O90GmiEJkdmSTWH4KjSkNUP6FZ
```

<br>

ูพุงุฑุงูุชุฑ `state` ูุนุงุฏู ููุฏุงุฑ ุชูุธู ุดุฏู ุชูุณุท ุงูพูฺฉุดู ุงุณุช. ุจุฑุง ุขู ููุฏุงุฑ ุชุตุงุฏู ู ฺฉุชุง (ุจุฑุง ูุฑ session) ุชูุธู ฺฉูุฏ ู ููฺฏุงู ุจุงุฒฺฏุดุช ุงู ููุฏุงุฑ ุฑุง ฺฺฉ ฺฉูุฏ ุชุง [ุฌูู ุณูุกุงุณุชูุงุฏูโูุง ุงุญุชูุงู][oauth > state] ุฑุง ุจฺฏุฑุฏ. 


ูพุงุฑุงูุชุฑ `code` ุฏุฑุตูุฑุช ุชูุธู ูโุดูุฏ ฺฉู ฺฉุงุฑุจุฑ ุงุฌุงุฒูโูุง ุฏุฑุฎูุงุณุช ุดุฏู ุฑุง ุฏุงุฏู ุจุงุดุฏ. ุจุง ุงู ูพุงุฑุงูุชุฑุ ูโุชูุงูุฏ ุฏุฑ [ฺฏุงู ุจุนุฏ][step 3]ุ ุงูุฏุงู ุจู ุฏุฑุงูุช ุชูฺฉู ุจุฑุง ูุฑุงุฎูุงู ูุงุจูุชโูุง ูุงุฒููุฏ ุงุฌุงุฒูโ ฺฉูุฏ. ุงฺฏุฑ ุงุฌุงุฒูโูุง ุฏุฑุฎูุงุณุช ุจุฑุง ุงุฏุงููโ ฺฉุงุฑ ุจุง ุงูพูฺฉุดู ุดูุง ุถุฑูุฑ ูุณุชูุฏุ ูโุชูุงูุฏ ูุจูุฏ ุงู ูพุงุฑุงูุชุฑ ุฑุง ุจู ููุฒููโ ุนุฏู ุตุฏูุฑ ุงุฌุงุฒู ุงุฒ ุฌุงูุจ ฺฉุงุฑุจุฑ ุชูู ฺฉุฑุฏู ู ุฎุทุง ูุฑุจูุทู ุฑุง ูุดุงู ุฏูุฏ.

<br>

## ๐๏ธ ฺฏุงู ุณูู: ุฏุฑุงูุช ุชูฺฉู

ุฏุฑ ุตูุฑุช ุฏุฑุงูุช ุงุฌุงุฒู ุงุฒ ุฌุงูุจ ฺฉุงุฑุจุฑ ู ุฏุฑุงูุช `code`ุ ูโุชูุงูุฏ ุงูุฏุงู ุจู ุฏุฑุงูุช access token ุงุฒ ุฏูุงุฑ ููุงุฏ. ุฏุฑ ุงู ุชูฺฉู ุงุฌุงุฒูโูุง ุฏุฑุงูุช ุงุฒ ุฌุงูุจ ฺฉุงุฑุจุฑ ุฐุฎุฑู ุดุฏูโุงูุฏ ู ุจุง ุงุณุชูุงุฏู ุงุฒ ุขู ูโุชูุงูุฏ ุงุฒ ูุงุจูุชโูุง ูุงุฒููุฏ ุงุฌุงุฒู ุงุณุชูุงุฏู ฺฉูุฏ.

ุจุฑุง ุฏุฑุงูุช access tokenุ ุฏุฑุฎูุงุณุช ุจู ุดฺฉู ุฒุฑ ุจูุฑุณุชุฏ:
```http request
POST https://api.divar.ir/oauth2/token
Content-Type: application/x-www-form-urlencoded

{
  "code": "c87sDtaqmWwgis7dYyukMqy6KAArNUFkukAPW8O90GmiEJkdmSTWH4KjSkNUP6FZ",
  "client_id": "{{app_slug}}",
  "client_secret": "{{client_secret}}",
  "grant_type": "authorization_code",
  "redirect_uri": "{{redirect_uri}}",
}
```
- ูพุงุฑุงูุชุฑ `code`: ููุฏุงุฑ ุฏุฑุงูุช ุฏุฑ [ฺฏุงู ูุจู][step 2] ุฑุง ูุฑุงุฑ ุฏูุฏ.
- ูพุงุฑุงูุชุฑ `client_id`: ูุงููุฏ [ฺฏุงู ุงูู][step 1]ุ [ุดูุงุณูโ ุงูพูฺฉุดู (Slug ุฏุฑ ูพูู ฺฉูุงุฑ)][ุฑุงูููุง ยป ุงุณูุงฺฏ] ุฑุง ูุฑุงุฑ ุฏูุฏ.
- ูพุงุฑุงูุชุฑ `client_secret`: ุงู ูพุงุฑุงูุชุฑ ุฏุฑ ุฒูุงู ุณุงุฎุช ุงูพ ุจู ุดูุง ุฏุงุฏู ูโุดูุฏ. ุจู ุนูุงูู ูโุชูุงูุฏ ุฏุฑ ุตูุฑุช ูุงุฒ ุฏุฑ ุตูุญูู ูุฏุฑุช ุงูพุ ฺฉูุฏ ูุญุฑูุงููู ุฌุฏุฏ ุจุณุงุฒุฏ.
- ูพุงุฑุงูุชุฑ `redirect_uri`: ููุฏุงุฑ ุงู ูพุงุฑุงูุชุฑ ุจุฑุงุจุฑ ุจุง ุขูฺู ุฏุฑ [ฺฏุงู ุงูู][step 1] ฺฏุฐุงุดุชู ุดุฏ ูโุจุงุดุฏ.

ูพุงุณุฎ ุจู ุงู ุฏุฑุฎูุงุณุชโูุง ุจู ุดฺฉู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:
```json
{
    "access_token": "ory_at_mAODvjM21UayVFDtP_KxsCDVwwpb5pwHoNks3vCIeJ8.Gx2sCv2jT4VIbbZDHDIRRwhi45AwV-St1W-gDNdxUUw",
    "expires_in": 3600,
    "scope": "...",
    "token_type": "bearer"
}
```

- ูพุงุฑุงูุชุฑ `access_token`: ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ูพุงุฑุงูุชุฑ ูโุชูุงูุฏ ุงุฒ ูุงุจูุชโูุง ูุงุฒููุฏ ุงุฌุงุฒูโ [ุงุณุชูุงุฏู ฺฉูุฏ][step 4].
- ูพุงุฑุงูุชุฑ `expires_in`: ุจู ุซุงููุ ูุดุงู ูุฏูุฏ ฺฉู ุงู ุชูฺฉู ุชุง ฺู ูุฏุช ูุนุชุจุฑ ุงุณุช.
- ูพุงุฑุงูุชุฑ `scope`: ุจุฑุงุจุฑ ุจุง scopeูุง ุฏุฑุฎูุงุณุช ุดุฏู ูโุจุงุดุฏ. 


<!--
- ูพุงุฑุงูุชุฑ `refresh_token`: ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ูพุงุฑุงูุชุฑ ูโุชูุงูุฏ ุชูฺฉู ุฌุฏุฏ ูุจู ุงุฒ ุงููุถุง ุชูฺฉู ูุจู ุฏุฑุงูุช ฺฉูุฏ:

```http request
POST https://api.divar.ir/v1/open-platform/oauth/access_token
Content-Type: application/json
x-api-key: {{api_key}}

{
  "refresh_token": "uXvX61ZI0wA7CDqk...",
  "grant_type": "refresh_token"
}
```
-->

<br>

## ๐ฎ ฺฏุงู ฺูุงุฑู: ุงุณุชูุงุฏู ุงุฒ ุชูฺฉู

ูพุณ ุงุฒ ุฏุฑุงูุช ุชูฺฉู ุจุง ุงุฌุงุฒูโูุง ููุฑุฏ ูุงุฒุ ูโุชูุงูุฏ ุงุฒ ูุงุจูุชโูุง ูุงุฒููุฏ ุงู ุงุฌุงุฒูโูุง ุงุณุชูุงุฏู ฺฉูุฏ. ุชูฺฉู ุฏุฑุงูุช ุฏุฑ [ฺฏุงู ูุจู][step 3] ุฑุง ุฏุฑ ูุฏุฑ `x-access-token` ูุฑุงุฑ ุฏูุฏ ู API ูุฑุจูุท ุจู ูุงุจูุช ููุฑุฏ ูุธุฑ ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ.

<br>

> ๐ก***ูุซุงู*** \
> ุจุฑุง ุฏุฑุงูุช ุดูุงุฑูโ ุชููู ฺฉุงุฑุจุฑุ ูพุณ ุงุฒ ุท ูุฑุงุญู ฺฉุณุจ ุงุฌุงุฒู ุงุฒ ฺฉุงุฑุจุฑุ ุฏุฑุฎูุงุณุช ุจู ุดฺฉู ุฒุฑ ุงุฑุณุงู ููุงุฏ:
> ```http request
> POST https://api.divar.ir/v1/open-platform/users
> Content-Type: application/json
> x-api-key: {{api_key}}
> x-access-token: {{access_token}}
> ```
> ูพุงุณุฎ ุงู ุฏุฑุฎูุงุณุช ุจู ุดฺฉู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:
> ```json
> {
>   "phone_numbers": ["09990000000"]
> }
> ```
> ุฏูุช ฺฉูุฏ ฺฉู ูู ฺฉูุฏ API (`api_key`) ูู ุชูฺฉู ุงุฌุงุฒูโ ฺฉุงุฑุจุฑ (`access_token`) ูุฑ ุฏู ุจุฑุง ูุฑุงุฎูุงู ุงู ูุงุจูุชโูุง ูุงุฒูโุงูุฏ. 


<br>

## โป๏ธ ฺฏุงู ูพูุฌู (ุงุฎุชุงุฑ): ุฏุฑุงูุช ุฑูุฑุด ุชูฺฉู

ุฏุฑ ุตูุฑุช ฺฉู ุฏุฑ [ฺฏุงู ุงูู][step 1] ููุฏุงุฑ `offline_access` ุฏุฑ scope ุจู ุนููุงู ฺฉ ุงุฒ ุงุณฺฉููพโูุง ูุฑุงุฑ ฺฏุฑุฏุ ุฏุฑ ุฌูุงุจ [ฺฏุงู ุณูู][step 3] ฺฉ ููุฏ ุงุถุงูู ุจุง ฺฉูุฏ `refresh_token` ูุฒ ุจุฑฺฏุฑุฏุงูุฏู ูโุดูุฏ. ุงุนุชุจุงุฑ ุงู ุชูฺฉู ณฐ ุฑูุฒ ูโุจุงุดุฏ ู ุจุนุฏ ุงุฒ ุขูุ ูุงุฒููุฏ ฺฏุฑูุชู ุฏุณุชุฑุณ ูุฌุฏุฏ ุงุฒ ฺฉุงุฑุจุฑ ูุณุชุฏ. ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ููุฏุงุฑ ูโุชูุงูุฏ ุงฺฉุณุณ ุชูฺฉู ุฎูุฏ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุฑุฎูุงุณุช ุฒุฑ ุชุงุฒูโุณุงุฒ ฺฉูุฏ:
```http request
POST https://api.divar.ir/oauth2/token
Content-Type: application/x-www-form-urlencoded

{
  "code": "{{current_access_token}}",
  "client_id": "{{app_slug}}",
  "client_secret": "{{client_secret}}",
  "grant_type": "refresh_token",
  "redirect_uri": "{{redirect_uri}}",
  "refresh_token": "{{refresh_token}}"
}
```
- ูพุงุฑุงูุชุฑ `code`: ุงฺฉุณุณ ุชูฺฉู ฺฉู ุฏุฑ ุงุฎุชุงุฑ ุฏุงุฑุฏ.
- ูพุงุฑุงูุชุฑ `client_id`: ูุงููุฏ [ฺฏุงู ุงูู][step 1]ุ [ุดูุงุณูโ ุงูพูฺฉุดู (Slug ุฏุฑ ูพูู ฺฉูุงุฑ)][ุฑุงูููุง ยป ุงุณูุงฺฏ] ุฑุง ูุฑุงุฑ ุฏูุฏ.
- ูพุงุฑุงูุชุฑ `client_secret`: ูโุชูุงูุฏ ุฏุฑ ุตูุญูู ูุฏุฑุช ุงูพุ ฺฉูุฏ ูุญุฑูุงููู ุฌุฏุฏ ุจุณุงุฒุฏ.
- ูพุงุฑุงูุชุฑ `redirect_uri`: ููุฏุงุฑ ฺฉู ุฏุฑ [ฺฏุงู ุณูู][step 3] ุจุฑุง ฺฏุฑูุชู ุชูฺฉู ูุฑุงุฑ ุฏุงุฏู ุดุฏู.
- ูพุงุฑุงูุชุฑ `refresh_token`: `refresh_token`ุง ฺฉู ุฏุฑ [ฺฏุงู ุณูู][step 3] ุฏุฑุงูุช ฺฉุฑุฏุฏ.

ูพุงุณุฎ ุจู ุงู ุฏุฑุฎูุงุณุชโูุง ุจู ุดฺฉู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:
```json
{
    "access_token": "ory_at_vV8nGHSkMumIEqojmUrq4Jdc8ZyifoNsdcUuMS2xr8s.P_1q_7d-xxHSAHuXUyB8YtLH4puqQA4hhO-TZGcpCtA",
    "expires_in": 3600,
    "refresh_token": "ory_rt_R9MRLXX9vY_AHmzvxTNrw80MdkgQ9xIC9WVbYDBvuyE.LpFjcEWK34WnI5DMj6CTObMFhvQ8N663ji3qj910M14",
    "scope": "...",
    "token_type": "bearer"
}
```


[ุฑุงูููุง ยป ุณุงุฎุช ุงูุฒููู]: /addons/approved_addon.md
[ุฑุงูููุง ยป ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ]: /oauth/get_user.md
[ูพูู ฺฉูุงุฑ]: https://divar.ir/kenar
[oauth]: https://oauth.net/2/
[oauth > tools]: https://oauth.net/code/
[ุฑุงูููุง ยป ุณุงุฎุช ุงูพ]: /management/ReadMe.md.md
[ุฑุงูููุง ยป ฺฉูุฏ]: /management/api-keys.md
[step 1]: /oauth/ReadMe.md#%EF%B8%8F-ฺฏุงู-ุงูู-ุฏุฑุฎูุงุณุช-ุงุฌุงุฒู
[step 2]: /oauth/ReadMe.md#%EF%B8%8F-ฺฏุงู-ุฏูู-ุจุงุฒฺฏุดุช-ุจู-ุงูพูฺฉุดู
[step 3]: /oauth/ReadMe.md#%EF%B8%8F-ฺฏุงู-ุณูู-ุฏุฑุงูุช-ุชูฺฉู 
[step 4]: /oauth/ReadMe.md#-ฺฏุงู-ฺูุงุฑู-ุงุณุชูุงุฏู-ุงุฒ-ุชูฺฉู
[step 5]: /oauth/ReadMe.md#%EF%B8%8F-ฺฏุงู-ูพูุฌู-ุงุฎุชุงุฑ-ุฏุฑุงูุช-ุฑูุฑุด-ุชูฺฉู
[ุฑุงูููุง ยป ุงุณูุงฺฏ]: /management#slug
[urlencode]: https://www.w3schools.com/tags/ref_urlencode.ASP
[ุงุฌุงุฒูโูุง]: /oauth/ReadMe.md#-ุงุฌุงุฒููุง-scope
[oauth > state]: https://stackoverflow.com/questions/26132066/what-is-the-purpose-of-the-state-parameter-in-oauth-authorization-request
[ุฑุงูููุง ยป ูุฏุฑุช ุงูพ]: /management
[base64]: https://developer.mozilla.org/en-US/docs/Glossary/Base64
[ุฑุงูููุง ยป ุงุฑุณุงู ูพุงู]: /chat/send_message.md
[ุฑุงูููุง ยป ุฏุณุชุฑุณ]: /management/api-keys.md#ุฏุณุชุฑุณูุง-ูพุฑฺฉุงุฑุจุฑุฏ
[unix time]: https://en.wikipedia.org/wiki/Unix_time 


<br><br>

<div align="center">

<img src="/img/wire-puzzle.svg" height="156px"/>

</div>

<br><br>
