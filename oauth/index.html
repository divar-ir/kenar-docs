<!doctype html>
<html lang="fa-IR" dir="rtl" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-oauth/ReadMe" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">احراز باز | کنار دیوار</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://divar-ir.github.io/kenar-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://divar-ir.github.io/kenar-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://divar-ir.github.io/kenar-docs/oauth/"><meta data-rh="true" property="og:locale" content="fa_IR"><meta data-rh="true" name="docusaurus_locale" content="fa-IR"><meta data-rh="true" name="docsearch:language" content="fa-IR"><meta data-rh="true" name="title" content="کنار دیوار"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="احراز باز | کنار دیوار"><meta data-rh="true" name="description" content="برخی قابلیت‌های کنار دیوار‌ نیازمند اجازه‌ی کاربرها هستند"><meta data-rh="true" property="og:description" content="برخی قابلیت‌های کنار دیوار‌ نیازمند اجازه‌ی کاربرها هستند"><link data-rh="true" rel="icon" href="/kenar-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://divar-ir.github.io/kenar-docs/oauth/"><link data-rh="true" rel="alternate" href="https://divar-ir.github.io/kenar-docs/oauth/" hreflang="fa-IR"><link data-rh="true" rel="alternate" href="https://divar-ir.github.io/kenar-docs/oauth/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://V8S0FQWY9Z-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="کنار دیوار" href="/kenar-docs/opensearch.xml"><link rel="stylesheet" href="/kenar-docs/assets/css/styles.289436a1.css">
<script src="/kenar-docs/assets/js/runtime~main.a9bde018.js" defer="defer"></script>
<script src="/kenar-docs/assets/js/main.e3f397cd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/kenar-docs/img/logo.svg"><link rel="preload" as="image" href="../img/wire-puzzle.svg"><div role="region" aria-label="پرش به مطلب اصلی"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">پرش به مطلب اصلی</a></div><nav aria-label="صفحه اصلی" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="باز و بست منو" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kenar-docs/"><div class="navbar__logo"><img src="/kenar-docs/img/logo.svg" alt="کنار دیوار" class="themedComponent_mlkZ themedComponent--light_NVdE" width="64"><img src="/kenar-docs/img/logo.svg" alt="کنار دیوار" class="themedComponent_mlkZ themedComponent--dark_xIcU" width="64"></div><b class="navbar__title text--truncate">| مستندات فنی</b></a><a href="https://github.com/divar-ir/kenar-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="بین حالت تاریک و روشن سوئیچ کنید (الان حالت روشن)" aria-label="بین حالت تاریک و روشن سوئیچ کنید (الان حالت روشن)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="جستجو (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">جستجو</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="بازگشت به بالا" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="نوار کناری مستندات" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kenar-docs/">ReadMe</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/addons/">افزونه‌های صفحهٔ آگهی</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;افزونه‌های صفحهٔ آگهی&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kenar-docs/assets/">اَسِت‌ها assets</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/chat/">💬 افزونه‌های چت دیوار</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;💬 افزونه‌های چت دیوار&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/events/">دریافت رویدادها در لحظه</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;دریافت رویدادها در لحظه&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/finder/">دریافت اطلاعات آگهی</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;دریافت اطلاعات آگهی&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/management/">پنل مدیریت اپلیکیشن‌ها</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;پنل مدیریت اپلیکیشن‌ها&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/kenar-docs/migrations/user_addon_v2+addon_v2+user_semantic">migrations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/misc/">متفرقه</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;متفرقه&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" href="/kenar-docs/oauth/">احراز باز</a><button aria-label="بستن دسته بندی در نوار کناری &#x27;احراز باز&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kenar-docs/oauth/get_user">دریافت اطلاعات کاربر</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/payment-ticket/">فلوی تیکت پرداخت</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;فلوی تیکت پرداخت&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/kenar-docs/post/edit_post">post</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/semantic/">اطلاعات معنایی</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;اطلاعات معنایی&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/standards/">استانداردها</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;استانداردها&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kenar-docs/widgets/">ساختار ویجت های دیوار (Widgets)</a><button aria-label="باز کردن دسته بندی در نوار کناری &#x27;ساختار ویجت های دیوار (Widgets)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="نشانگر صفحات"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="صفحه اصلی" class="breadcrumbs__link" href="/kenar-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">احراز باز</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">مطالب این صفحه</button></div><div class="theme-doc-markdown markdown"><header><h1>احراز باز</h1></header>
<p>برخی قابلیت‌های <strong>کنار دیوار</strong>‌ نیازمند اجازه‌ی کاربرها هستند: مثلا <a href="/kenar-docs/addons/create">افزودن محتوا به آگهی</a> یا <a href="/kenar-docs/oauth/get_user">دریافت اطلاعات کاربر</a> نیازمند کسب اجازه از کاربر است. در <strong>کنار دیوار</strong>، فرآیند کسب اجازه از کاربر طبق استاندارد <a href="https://oauth.net/2/" target="_blank" rel="noopener noreferrer">OAuth 2.0</a> انجام می‌شود:</p>
<p>۱. 🖐️ اپلیکیشن کاربر را برای کسب اجازه <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%A7%D9%88%D9%84-%D8%AF%D8%B1%D8%AE%D9%88%D8%A7%D8%B3%D8%AA-%D8%A7%D8%AC%D8%A7%D8%B2%D9%87">به دیوار هدایت (redirect) می‌کند</a>. <br>
<!-- -->۲. ↪️ کاربر، بعد از صدور یا رد اجازه‌های درخواستی، <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%AF%D9%88%D9%85-%D8%A8%D8%A7%D8%B2%DA%AF%D8%B4%D8%AA-%D8%A8%D9%87-%D8%A7%D9%BE%D9%84%DB%8C%DA%A9%DB%8C%D8%B4%D9%86">به آدرس مشخص‌شده توسط اپلیکیشن (redirect URI) هدایت می‌شود</a>. <br>
<!-- -->۳. 🗝️ درصورت صدور اجازه، اپلیکیشن می‌تواند از دیوار <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%B3%D9%88%D9%85-%D8%AF%D8%B1%DB%8C%D8%A7%D9%81%D8%AA-%D8%AA%D9%88%DA%A9%D9%86">توکنی (access token) برای استفاده از قابلیت‌های مدنظر دریافت ‌کند</a>. <br>
<!-- -->۴. 🔮 اپلیکیشن با استفاده از توکن دریافتی، <a href="/kenar-docs/oauth/#-%DA%AF%D8%A7%D9%85-%DA%86%D9%87%D8%A7%D8%B1%D9%85-%D8%A7%D8%B3%D8%AA%D9%81%D8%A7%D8%AF%D9%87-%D8%A7%D8%B2-%D8%AA%D9%88%DA%A9%D9%86">از قابلیت‌های مدنظر استفاده می‌کند</a>. <br>
<!-- -->۵. ♻️ در صورت نیاز، اپلیکیشن با استفاده از رفرش توکن دریافتی، <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D9%BE%D9%86%D8%AC%D9%85-%D8%A7%D8%AE%D8%AA%DB%8C%D8%A7%D8%B1%DB%8C-%D8%AF%D8%B1%DB%8C%D8%A7%D9%81%D8%AA-%D8%B1%D9%81%D8%B1%D8%B4-%D8%AA%D9%88%DA%A9%D9%86">می‌تواند توکن جدید دریافت کند</a>.</p>
<br>
<br>
<!-- -->
<br>
<br>
<hr>
<p>🚀 ابزارهای متنوعی برای کار با استاندارد OAuth 2.0 در زبان‌ها و فریم‌ورک‌های مختلف وجود دارد. برخی از این ابزارها را می‌توانید <a href="https://oauth.net/code/" target="_blank" rel="noopener noreferrer">اینجا ببینید</a>.</p>
<hr>
<br>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-گام-اول-درخواست-اجازه">🖐️ گام اول: درخواست اجازه<a href="#️-گام-اول-درخواست-اجازه" class="hash-link" aria-label="لینک مستقیم به 🖐️ گام اول: درخواست اجازه" title="لینک مستقیم به 🖐️ گام اول: درخواست اجازه">​</a></h2>
<p>برای درخواست اجازه، کاربر را به آدرسی به شکل زیر هدایت (redirect) کنید:</p>
<div class="language-url codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-url codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://api.divar.ir/oauth2/auth?response_type=code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;client_id=&lt;app-slug&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;redirect_uri=&lt;redirect-uri&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;scope=&lt;scopes&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;state=&lt;state&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><em>پارامتر <code>client_id</code></em>: در این پارامتر <a href="/kenar-docs/management#slug">شناسه‌ی اپلیکیشن (Slug در پنل کنار)</a> را قرار دهید.</li>
<li><em>پارامتر <code>redirect_uri</code></em>: آدرسی از اپلیکیشن که کاربر بعد از صدور (یا رد) اجازه‌های درخواستی به آن هدایت شود.<!-- -->
<ul>
<li>هیچ پارامتری در این آدرس قرار ندهید!</li>
<li>مقدار <code>redirect_uri</code> حتما باید <a href="https://www.w3schools.com/tags/ref_urlencode.ASP" target="_blank" rel="noopener noreferrer">URL encode</a> شده باشد.</li>
<li>این آدرس باید با یکی از آدرس هایی که در <a href="https://divar.ir/kenar" target="_blank" rel="noopener noreferrer">پنل کنار</a> به منظور آدرس‌های مجاز برای هدایت از OAuth تنظیم کرده‌اید مطابقت داشته باشد.</li>
</ul>
</li>
<li><em>پارامتر <code>scope</code></em>: اجازه‌های مورد نیاز را در این پارامتر لیست  و با اسپیس <code>&quot; &quot;</code> از هم جدا کنید. <a href="/kenar-docs/oauth/#-%D8%A7%D8%AC%D8%A7%D8%B2%D9%87%D9%87%D8%A7-scope">در مورد اجازه‌ها اینجا را بخوانید</a>.<!-- -->
<ul>
<li>مقدار <code>scope</code> حتما باید <a href="https://www.w3schools.com/tags/ref_urlencode.ASP" target="_blank" rel="noopener noreferrer">URL encode</a> شده باشد.</li>
<li>در صورتی که نیاز به refresh_token دارید می‌توانید، offline_access را نیز در لیست scopeها ارسال کنید تا در پاسخ، refresh_token دریافت کنید. اطلاعات بیشتر را در <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D9%BE%D9%86%D8%AC%D9%85-%D8%A7%D8%AE%D8%AA%DB%8C%D8%A7%D8%B1%DB%8C-%D8%AF%D8%B1%DB%8C%D8%A7%D9%81%D8%AA-%D8%B1%D9%81%D8%B1%D8%B4-%D8%AA%D9%88%DA%A9%D9%86">گام پنجم</a> بخوانید.</li>
</ul>
</li>
<li><em>پارامتر <code>state</code></em>: یک مقدار دلخواه که در بازگشت کاربر به اپلیکیشن شما مجدد در پارامترهای URL قرار می‌گیرد.<!-- -->
<ul>
<li>با استفاده از پارامتر <code>state</code> می‌توانید منشاء درخواست بازگشته را احراز نمایید.</li>
<li>اگر برای <code>redirect_uri</code> نیاز به تنظیم پارامتری دارید، مقادیر این پارامترها را می‌توانید در <code>state</code> ذخیره کنید.</li>
<li>دقت کنید که حتما <code>state</code> شامل مقادیری یکتا و تصادفی باشد تا بتوانید <a href="https://stackoverflow.com/questions/26132066/what-is-the-purpose-of-the-state-parameter-in-oauth-authorization-request" target="_blank" rel="noopener noreferrer">درخواست‌های بازگشت دروغین</a> را تشخیص دهید.</li>
</ul>
</li>
</ul>
<br>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-اجازهها-scope">🛂 اجازه‌ها (Scope)<a href="#-اجازهها-scope" class="hash-link" aria-label="لینک مستقیم به 🛂 اجازه‌ها (Scope)" title="لینک مستقیم به 🛂 اجازه‌ها (Scope)">​</a></h3>
<p>قابلیت‌های مختلف، نیازمند کسب اجازه (یا scope)های متفاوت از کاربر هستند. برخی از این اجازه‌ها مربوط به <em>شیء خاصی</em> هستند: مثلا برای افزودن محتوا به یک آگهی خاص، می‌بایست اجازه‌ی ساخت افزونه بر روی همان آگهی را از کاربر دریافت کنید. این نوع اجازه‌ها از شکل کلی <code>SCOPE.IDENTIFIER</code> تبعیت می‌کنند که در آن:</p>
<ul>
<li>قسمت <code>SCOPE</code> نمایانگر کلی اجازه‌ی مربوطه (مثلا <a href="/kenar-docs/addons/create">اضافه کردن افزونه به آگهی</a>) است.</li>
<li>قسمت <code>IDENTIFIER</code> نمایانگر <em>شیء خاصیست</em> که اجازه مربوط به آنست (مثلا شناسه‌ی آگهی).</li>
</ul>
<br>
<blockquote>
<p>💡 <em><strong>مثال</strong></em> <br>
<!-- -->برای دریافت اجازه‌ برای اضافه کردن افزونه به آگهی با شناسه‌ی <code>AZTH74V2</code>، پارامتر scope را به شکل زیر مقدار دهید. شناسه‌ی آگهی را می‌توانید از پارامتر <code>post_token</code> که هنگام <a href="/kenar-docs/management">فراخوانی اپلیکیشن</a> ارائه شده است بخوانید.</p>
<div class="language-url codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-url codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&amp;scope=POST_ADDON_CREATE.AZTH74V2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</blockquote>
<br>
<p>برخی اجازه‌های دیگر مربوط به <em>شیء خاصی</em> نیستند و عمومی هستند: برای مثال دریافت شماره‌ی تلفن کاربر (برای یک کاربر خاص) یک اجازه (scope) عمومیست. این نوع اجازه‌ها با شکل <code>SCOPE</code> نمایانده می‌شوند.</p>
<br>
<blockquote>
<p>💡 <em><strong>مثال</strong></em> <br>
<!-- -->برای دریافت اجازه‌ی دسترسی به شماره‌ی تلفن کاربر، پارامتر scope را به شکل زیر تنظیم کنید:</p>
<div class="language-url codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-url codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&amp;scope=USER_PHONE</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</blockquote>
<br>
<blockquote>
<p>💡 <em><strong>مثال</strong></em> <br>
<!-- -->برای دریافت اجازه‌ی دسترسی برای ارسال پیام به کاربر بر روی مکالمه با شناسه‌ی <code>62c82c02-6a71-4501-a1fd-4bf226b3aa78</code>،  پارامتر scope را به شکل زیر ارسال نمایید:</p>
<div class="language-url codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-url codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&amp;scope=CONVERSATION_SEND_MESSAGE.62c82c02-6a71-4501-a1fd-4bf226b3aa78</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</blockquote>
<br>
<p>پارامتر scope می‌تواند شامل چند اجازه‌ باشد، که در این صورت باید از فرم کلی <code>SCOPE_1 SCOPE_2 SCOPE_3 ...</code> یا <code>SCOPE_1%20SCOPE_2%20SCOPE_3 ...</code> تبعیت کند.</p>
<br>
<blockquote>
<p>💡<em><strong>مثال</strong></em> <br>
<!-- -->برای دریافت همزمان اجازه‌ی دسترسی به شماره‌ی کاربر و اجازه‌ی اضافه کردن افزونه به آگهی با شناسه‌ی <code>AZTH74V2</code>، پارامتر scope را به شکل زیر مقدار دهید:</p>
<div class="language-url codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-url codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&amp;scope=USER_PHONE POST_ADDON_CREATE.AZTH74V2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;scope=USER_PHONE%20POST_ADDON_CREATE.AZTH74V2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</blockquote>
<br>
<p>اجازه‌های مورد نیاز هر قابلیت را در صفحه‌ی مربوط به آن قابلیت می‌توانید ببینید. جدول زیر لیستی از اجازه‌های پرکاربرد را نشان می‌دهد.</p>
<div align="right"><table><thead><tr><th>قابلیت</th><th>اجازه</th><th>مثال</th></tr></thead><tbody><tr><td><a href="/kenar-docs/addons/create">ساخت افزونه</a></td><td>POST_ADDON_CREATE</td><td><code>POST_ADDON_CREATE.AZTH74V2</code></td></tr><tr><td><a href="/kenar-docs/chat/users_conversations">ارسال پیام در چت</a></td><td>CONVERSATION_SEND_MESSAGE</td><td><code>CONVERSATION_SEND_MESSAGE.62c82c02-6a71-4501-a1fd-4bf226b3aa78</code></td></tr><tr><td><a href="/kenar-docs/oauth/get_user">دریافت شماره‌ی تلفن کاربر</a></td><td>USER_PHONE</td><td><code>USER_PHONE</code></td></tr></tbody></table></div>
<br>
<hr>
<p>🛂 اجازه‌ها مستقل از دسترسی‌های <a href="/kenar-docs/management/api-keys">کلیدهای API</a> شما هستند. برای استفاده از هر قابلیت می‌باید هم کلیدی با دسترسی‌های لازم استفاده کنید، هم اجازه‌های مورد نیاز را از کاربر دریافت نمایید. برای اطلاعات بیشتر در مورد دسترسی‌ها، <a href="/kenar-docs/management/api-keys#%D8%AF%D8%B3%D8%AA%D8%B1%D8%B3%DB%8C%D9%87%D8%A7%DB%8C-%D9%BE%D8%B1%DA%A9%D8%A7%D8%B1%D8%A8%D8%B1%D8%AF">اینجا را بخوانید</a>.</p>
<hr>
<br>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-گام-دوم-بازگشت-به-اپلیکیشن">↪️ گام دوم: بازگشت به اپلیکیشن<a href="#️-گام-دوم-بازگشت-به-اپلیکیشن" class="hash-link" aria-label="لینک مستقیم به ↪️ گام دوم: بازگشت به اپلیکیشن" title="لینک مستقیم به ↪️ گام دوم: بازگشت به اپلیکیشن">​</a></h2>
<p>بعد از اتمام فرآیند کسب اجازه، چه در صورت تایید و چه در صورت رد اجازه‌های درخواستی توسط کاربر، وی به آدرس مشخص‌شده در پارامتر <code>redirect_uri</code> در <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%A7%D9%88%D9%84-%D8%AF%D8%B1%D8%AE%D9%88%D8%A7%D8%B3%D8%AA-%D8%A7%D8%AC%D8%A7%D8%B2%D9%87">گام قبل</a> هدایت (redirect) می‌شود. برای مثال، اگر مقدار <code>redirect_uri</code> در <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%A7%D9%88%D9%84-%D8%AF%D8%B1%D8%AE%D9%88%D8%A7%D8%B3%D8%AA-%D8%A7%D8%AC%D8%A7%D8%B2%D9%87">گام قبل</a> به شکل زیر داده شده باشد:</p>
<div class="language-url codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-url codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://api.divar.ir/oauth2/auth?response_type=code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;cliend_id=...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;scope=...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;state=my-random-string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;redirect_uri=oauth-redirect.my-app.ir</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>بعد از اتمام فرآیند، کاربر به آدرسی به شکل زیر هدایت می‌شود:</p>
<div class="language-url codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-url codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://oauth-redirect.my-app.ir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ?state=my-random-string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;code=c87sDtaqmWwgis7dYyukMqy6KAArNUFkukAPW8O90GmiEJkdmSTWH4KjSkNUP6FZ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<br>
<p>پارامتر <code>state</code> معادل مقدار تنظیم شده توسط اپلیکیشن است. برای آن مقدار تصادفی و یکتایی (برای هر session) تنظیم کنید و هنگام بازگشت این مقدار را چک کنید تا <a href="https://stackoverflow.com/questions/26132066/what-is-the-purpose-of-the-state-parameter-in-oauth-authorization-request" target="_blank" rel="noopener noreferrer">جلوی سوءاستفاده‌های احتمالی</a> را بگیرید.</p>
<p>پارامتر <code>code</code> درصورتی تنظیم می‌شود که کاربر اجازه‌های درخواست شده را داده باشد. با این پارامتر، می‌توانید در <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%B3%D9%88%D9%85-%D8%AF%D8%B1%DB%8C%D8%A7%D9%81%D8%AA-%D8%AA%D9%88%DA%A9%D9%86">گام بعدی</a>، اقدام به دریافت توکنی برای فراخوانی قابلیت‌های نیازمند اجازه‌ کنید. اگر اجازه‌های درخواستی برای ادامه‌ی کار با اپلیکیشن شما ضروری هستند، می‌توانید نبود این پارامتر را به منزله‌ی عدم صدور اجازه از جانب کاربر تلقی کرده و خطای مربوطه را نشان دهید.</p>
<br>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-گام-سوم-دریافت-توکن">🗝️ گام سوم: دریافت توکن<a href="#️-گام-سوم-دریافت-توکن" class="hash-link" aria-label="لینک مستقیم به 🗝️ گام سوم: دریافت توکن" title="لینک مستقیم به 🗝️ گام سوم: دریافت توکن">​</a></h2>
<p>در صورت دریافت اجازه از جانب کاربر و دریافت <code>code</code>، می‌توانید اقدام به دریافت access token از دیوار نمایید. در این توکن اجازه‌های دریافتی از جانب کاربر ذخیره شده‌اند و با استفاده از آن می‌توانید از قابلیت‌های نیازمند اجازه استفاده کنید.</p>
<p>برای دریافت access token، درخواستی به شکل زیر بفرستید:</p>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST https://api.divar.ir/oauth2/token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Content-Type</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">application/x-www-form-urlencoded</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;code&quot;: &quot;c87sDtaqmWwgis7dYyukMqy6KAArNUFkukAPW8O90GmiEJkdmSTWH4KjSkNUP6FZ&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;client_id&quot;: &quot;{{app_slug}}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;client_secret&quot;: &quot;{{client_secret}}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;grant_type&quot;: &quot;authorization_code&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;redirect_uri&quot;: &quot;{{redirect_uri}}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>پارامتر <code>code</code>: مقدار دریافتی در <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%AF%D9%88%D9%85-%D8%A8%D8%A7%D8%B2%DA%AF%D8%B4%D8%AA-%D8%A8%D9%87-%D8%A7%D9%BE%D9%84%DB%8C%DA%A9%DB%8C%D8%B4%D9%86">گام قبل</a> را قرار دهید.</li>
<li>پارامتر <code>client_id</code>: مانند <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%A7%D9%88%D9%84-%D8%AF%D8%B1%D8%AE%D9%88%D8%A7%D8%B3%D8%AA-%D8%A7%D8%AC%D8%A7%D8%B2%D9%87">گام اول</a>، <a href="/kenar-docs/management#slug">شناسه‌ی اپلیکیشن (Slug در پنل کنار)</a> را قرار دهید.</li>
<li>پارامتر <code>client_secret</code>: این پارامتر در زمان ساخت اپ به شما داده می‌شود. به علاوه می‌توانید در صورت نیاز در صفحهٔ مدیریت اپ، کلید محرمانهٔ جدید بسازید.</li>
<li>پارامتر <code>redirect_uri</code>: مقدار این پارامتر برابر با آنچه در <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%A7%D9%88%D9%84-%D8%AF%D8%B1%D8%AE%D9%88%D8%A7%D8%B3%D8%AA-%D8%A7%D8%AC%D8%A7%D8%B2%D9%87">گام اول</a> گذاشته شد می‌باشد.</li>
</ul>
<p>پاسخ به این درخواست‌ها به شکل زیر خواهد بود:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;access_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ory_at_mAODvjM21UayVFDtP_KxsCDVwwpb5pwHoNks3vCIeJ8.Gx2sCv2jT4VIbbZDHDIRRwhi45AwV-St1W-gDNdxUUw&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;expires_in&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;scope&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;...&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;token_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bearer&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>پارامتر <code>access_token</code>: با استفاده از این پارامتر می‌توانید از قابلیت‌های نیازمند اجازه‌ <a href="/kenar-docs/oauth/#-%DA%AF%D8%A7%D9%85-%DA%86%D9%87%D8%A7%D8%B1%D9%85-%D8%A7%D8%B3%D8%AA%D9%81%D8%A7%D8%AF%D9%87-%D8%A7%D8%B2-%D8%AA%D9%88%DA%A9%D9%86">استفاده کنید</a>.</li>
<li>پارامتر <code>expires_in</code>: به ثانیه، نشان میدهد که این توکن تا چه مدت معتبر است.</li>
<li>پارامتر <code>scope</code>: برابر با scopeهای درخواست شده می‌باشد.</li>
</ul>
<br>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-گام-چهارم-استفاده-از-توکن">🔮 گام چهارم: استفاده از توکن<a href="#-گام-چهارم-استفاده-از-توکن" class="hash-link" aria-label="لینک مستقیم به 🔮 گام چهارم: استفاده از توکن" title="لینک مستقیم به 🔮 گام چهارم: استفاده از توکن">​</a></h2>
<p>پس از دریافت توکن با اجازه‌های مورد نیاز، می‌توانید از قابلیت‌های نیازمند این اجازه‌ها استفاده کنید. توکن دریافتی در <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%B3%D9%88%D9%85-%D8%AF%D8%B1%DB%8C%D8%A7%D9%81%D8%AA-%D8%AA%D9%88%DA%A9%D9%86">گام قبل</a> را در هدر <code>x-access-token</code> قرار دهید و API مربوط به قابلیت مورد نظر را فراخوانی کنید.</p>
<br>
<blockquote>
<p>💡<em><strong>مثال</strong></em> <br>
<!-- -->برای دریافت شماره‌ی تلفن کاربر، پس از طی مراحل کسب اجازه از کاربر، درخواستی به شکل زیر ارسال نمایید. لازم به ذکر است، می‌بایست این درخواست به صورت فرم ارسال گردد:</p>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST https://api.divar.ir/v1/open-platform/users</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Content-Type</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">application/json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">x-api-key</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">{{api_key}}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">x-access-token</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">{{access_token}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>پاسخ این درخواست به شکل زیر خواهد بود:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;phone_numbers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;09990000000&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>دقت کنید که هم کلید API (<code>api_key</code>) هم توکن اجازه‌ی کاربر (<code>access_token</code>) هر دو برای فراخوانی این قابلیت‌ها لازم‌اند.</p>
</blockquote>
<br>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-گام-پنجم-اختیاری-دریافت-رفرش-توکن">♻️ گام پنجم (اختیاری): دریافت رفرش توکن<a href="#️-گام-پنجم-اختیاری-دریافت-رفرش-توکن" class="hash-link" aria-label="لینک مستقیم به ♻️ گام پنجم (اختیاری): دریافت رفرش توکن" title="لینک مستقیم به ♻️ گام پنجم (اختیاری): دریافت رفرش توکن">​</a></h2>
<p>در صورتی که در <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%A7%D9%88%D9%84-%D8%AF%D8%B1%D8%AE%D9%88%D8%A7%D8%B3%D8%AA-%D8%A7%D8%AC%D8%A7%D8%B2%D9%87">گام اول</a> در فهرست scopeها <code>offline_access</code> هم قراردهید، در جواب <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%B3%D9%88%D9%85-%D8%AF%D8%B1%DB%8C%D8%A7%D9%81%D8%AA-%D8%AA%D9%88%DA%A9%D9%86">گام سوم</a> یک فیلد اضافه با کلید <code>refresh_token</code> نیز برگردانده می‌شود. اعتبار این توکن ۳۰ روز می‌باشد و بعد از آن، نیازمند گرفتن دسترسی مجدد از کاربر هستید. با استفاده از این مقدار می‌توانید اکسس توکن خود را با استفاده از درخواست زیر تازه‌سازی کنید:</p>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST https://api.divar.ir/oauth2/token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Content-Type</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">application/x-www-form-urlencoded</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;code&quot;: &quot;{{current_access_token}}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;client_id&quot;: &quot;{{app_slug}}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;client_secret&quot;: &quot;{{client_secret}}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;grant_type&quot;: &quot;refresh_token&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;redirect_uri&quot;: &quot;{{redirect_uri}}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;refresh_token&quot;: &quot;{{refresh_token}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>پارامتر <code>code</code>: اکسس توکنی که در اختیار دارید.</li>
<li>پارامتر <code>client_id</code>: مانند <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%A7%D9%88%D9%84-%D8%AF%D8%B1%D8%AE%D9%88%D8%A7%D8%B3%D8%AA-%D8%A7%D8%AC%D8%A7%D8%B2%D9%87">گام اول</a>، <a href="/kenar-docs/management#slug">شناسه‌ی اپلیکیشن (Slug در پنل کنار)</a> را قرار دهید.</li>
<li>پارامتر <code>client_secret</code>: می‌توانید در صفحهٔ مدیریت اپ، کلید محرمانهٔ جدید بسازید.</li>
<li>پارامتر <code>redirect_uri</code>: مقداری که در <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%B3%D9%88%D9%85-%D8%AF%D8%B1%DB%8C%D8%A7%D9%81%D8%AA-%D8%AA%D9%88%DA%A9%D9%86">گام سوم</a> برای گرفتن توکن قرار داده شده.</li>
<li>پارامتر <code>refresh_token</code>: <code>refresh_token</code>ای که در <a href="/kenar-docs/oauth/#%EF%B8%8F-%DA%AF%D8%A7%D9%85-%D8%B3%D9%88%D9%85-%D8%AF%D8%B1%DB%8C%D8%A7%D9%81%D8%AA-%D8%AA%D9%88%DA%A9%D9%86">گام سوم</a> دریافت کردید.</li>
</ul>
<p>پاسخ به این درخواست‌ها به شکل زیر خواهد بود:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;access_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ory_at_vV8nGHSkMumIEqojmUrq4Jdc8ZyifoNsdcUuMS2xr8s.P_1q_7d-xxHSAHuXUyB8YtLH4puqQA4hhO-TZGcpCtA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;expires_in&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;refresh_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ory_rt_R9MRLXX9vY_AHmzvxTNrw80MdkgQ9xIC9WVbYDBvuyE.LpFjcEWK34WnI5DMj6CTObMFhvQ8N663ji3qj910M14&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;scope&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;...&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;token_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bearer&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="کپی به کلیپ‌بورد" title="کپی" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<br>
<br>
<div align="center"><img src="../img/wire-puzzle.svg" height="156px"></div>
<br>
<br></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/divar-ir/kenar-docs/tree/master/docs/oauth/ReadMe.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ویرایش مطالب این صفحه</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="صفحات مستندات"><a class="pagination-nav__link pagination-nav__link--prev" href="/kenar-docs/misc/post"><div class="pagination-nav__sublabel">قبلی</div><div class="pagination-nav__label">چرخه زندگی آگهی‌های دیوار</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kenar-docs/oauth/get_user"><div class="pagination-nav__sublabel">بعدی</div><div class="pagination-nav__label">دریافت اطلاعات کاربر</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#️-گام-اول-درخواست-اجازه" class="table-of-contents__link toc-highlight">🖐️ گام اول: درخواست اجازه</a><ul><li><a href="#-اجازهها-scope" class="table-of-contents__link toc-highlight">🛂 اجازه‌ها (Scope)</a></li></ul></li><li><a href="#️-گام-دوم-بازگشت-به-اپلیکیشن" class="table-of-contents__link toc-highlight">↪️ گام دوم: بازگشت به اپلیکیشن</a></li><li><a href="#️-گام-سوم-دریافت-توکن" class="table-of-contents__link toc-highlight">🗝️ گام سوم: دریافت توکن</a></li><li><a href="#-گام-چهارم-استفاده-از-توکن" class="table-of-contents__link toc-highlight">🔮 گام چهارم: استفاده از توکن</a></li><li><a href="#️-گام-پنجم-اختیاری-دریافت-رفرش-توکن" class="table-of-contents__link toc-highlight">♻️ گام پنجم (اختیاری): دریافت رفرش توکن</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">2025 © <a href="https://divar.ir/kenar" target="_blank">کنار دیوار</a></div></div></div></footer></div>
</body>
</html>